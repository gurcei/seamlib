#OUTPUT "SEAMLIB"#DEFINE ”–“ØÕ¡ÿ = 13 - 1CLR'--------.DECLARES'--------#DECLARE FIDX, FRAMEØCOUNT%, ANIMØCOUNT#DECLARE BKPØD054&, BKPØD058&, BKPØD059&, BKPØD05E&#DECLARE MYØERR$, K, IDX, X, Y, VALUE' FRAME DETAILS#DECLARE DEFAULTØSLICE(100), CHARØTYPE(100), CHARØIDX%(100)#DECLARE CHRØWIDTH%(100), CHRØHEIGHT%(100)#DECLARE BBØTLX&(100,10), BBØTLY&(100,10), BBØBRX&(100,10), BBØBRY&(100,10)#DECLARE BBØCNT&(100)#DECLARE OLDØFIDX' SPRITE DETAILS#DECLARE SPRØCHRØWIDTH%(100), SPRØCHRØHEIGHT%(100), SPRØCHARØIDX%(100)#DECLARE SPRØFRAMEØCOUNT%(100), SPRØFRAMES&(100,20), SPRØVISIBLE%(100)#DECLARE SPRØFIDX&(100), STAGEØXØOFFS%(100), SPRØCOUNT#DECLARE SPRØOX%(100), SPRØOY%(100)#DECLARE SPRØCOLLIDE&(”–“ØÕ¡ÿ ,”–“ØÕ¡ÿ)#DECLARE OBJX, OBJY, OLDYY, MINYY, MAXYY, YYBOT #DECLARE A$, YY, OFFSY, TMP, TMPX, TMPY#DECLARE TCLR, TX, TY, REVØFLAG, CHR#DECLARE LN$, CHARØCOUNT, XX, KK, SIDX, OLDØSIDX, ANIMØTMR#DECLARE CX, CY, SIDX2, OBJX2, OBJY2, K1, K2#DECLARE BOX1ØX1%, BOX1ØY1%, BOX1ØX2%, BOX1ØY2%#DECLARE BOX2ØX1%, BOX2ØY1%, BOX2ØX2%, BOX2ØY2%#DECLARE COLLISIONØFLAG, FIDX2#DECLARE APTRØLO, APTRØHI, SCORE, HEALTH, RADIUS#DECLARE WOLFØX(3), WOLFØY(3), WOLFØVX(3), WOLFØVY(3), DX, DY#DECLARE PANEØX%, PANEØY%, PANEØWIDTH%, PANEØHEIGHT%#DECLARE GAMEØOVERØFLAG#DECLARE CYCLEØSTART, COLOURØCYCLEØFLAG#DECLARE DEFAULTØRED&(32), DEFAULTØGREEN&(32), DEFAULTØBLUE&(32)#DECLARE GIRLØVX, GIRLØVY, WOLFØDIE(3), KEYØFLAG#DECLARE GEMØX(2), GEMØY(2), GEMØVX(2), GEMØVY(2), CHESTØTIME#DECLARE WIDX, WOLFØCNT, BKPØD051&, V, B$, JVAL#DECLARE TITLEØCHRØWIDTH%(10), TITLEØCHRØHEIGHT%(10), TITLEØCHARØIDX%(10)#DECLARE TITLEØOX%(10), TITLEØOY%(10), TITLEØSTAGEØXØOFFS%(10)#DECLARE TITLEØCOUNT, DR#DECLARE SNDØIDX, SNDØORDER(5), GX, WATER, ITER, WOLFØSPEED#DECLARE CARPETØTIME, HSØNAME$(3), HSØSCORE(3)#DECLARE DEBUGØBB = 0.MUSICØVARS'----------#DEFINE CHUNKØMAX = 50#DECLARE CHUNKØCNT, CHUNKØIDX, VIDX, TMPO%, ROW#DECLARE ECHOØM, ECHOØB, ECHOØSZ = .05, CHUNKØRPT, ECHOØDELAY#DECLARE V$(5,CHUNKØMAX), V#DECLARE SONG$#DECLARE V1$, V2$, V3$, V4$, V5$, V6$#DECLARE CURRØFREQ, CURRØDIR#DECLARE SEQCNT#DECLARE SEQØCHUNK(200), SEQØEXTRA(200)#DECLARE PLYPTR, PLYFLAG, RET%, TMP$, PLAYIDX%#DECLARE ATTACK, DECAY, SUSTAIN, RELEASE, WAVEFORM, PW#DECLARE INITIALØRUN, ENDØTIME'-------.DEFINES'-------#DEFINE À≈ŸØ≈”√¡–≈ = CHR$(27)#DEFINE À≈ŸØ“≈÷ØœŒ = ""#DEFINE À≈ŸØ“≈÷Øœ∆∆ = "í"#DEFINE À≈ŸØ’– = "ë"#DEFINE À≈ŸØƒœ◊Œ = ""#DEFINE À≈ŸØÃ≈∆‘ = "ù"#DEFINE À≈ŸØ“…«»‘ = ""#DEFINE À≈ŸØÕ≈«¡Ø— = "´"#DEFINE ◊…ƒ‘» = 270#DEFINE œ–Ø√œ–Ÿ = 0#DEFINE œ–ØÕ…ÿ  = 1#DEFINE œ–Ø”◊¡– = 2#DEFINE œ–Ø∆…ÃÃ = 3#DEFINE …Œ÷¡Ã…ƒ = -666' SEAM FRAMES#DEFINE ∆Ø√¡“–≈‘ = 0#DEFINE ∆Ø◊œÃ∆1 = 1#DEFINE ∆ØÀ≈Ÿ = 2#DEFINE ∆Ø¬¡Œ¡Œ¡ = 3#DEFINE ∆Ø◊¬œ‘‘Ã≈ = 4#DEFINE ∆Ø◊œÃ∆2 = 5#DEFINE ∆Ø«…“Ã1 = 6#DEFINE ∆Ø«…“Ã2 = 7#DEFINE ∆Ø√»≈”‘2 = 8#DEFINE ∆Ø√»≈”‘1 = 9#DEFINE ∆Ø«≈Õ1 = 10#DEFINE ∆Ø«≈Õ2 = 11#DEFINE ∆Ø«≈Õ3 = 12#DEFINE ∆Ø√»¡“Ø” = 13#DEFINE ∆Ø√»¡“Ø– = 14#DEFINE ∆Ø√»¡“Ø“ = 15#DEFINE ∆Ø√»¡“Ø… = 16#DEFINE ∆Ø√»¡“ØŒ = 17#DEFINE ∆Ø√»¡“Ø« = 18' SEAM SPRITES#DEFINE ”Ø√¡“–≈‘ = 0#DEFINE ”Ø¬¡Œ¡Œ¡ = 1#DEFINE ”Ø◊¬œ‘‘Ã≈ = 2#DEFINE ”Ø√»≈”‘ = 3#DEFINE ”ØÀ≈Ÿ = 4#DEFINE ”Ø«≈Õ1 = 5#DEFINE ”Ø«≈Õ2 = 6#DEFINE ”Ø«≈Õ3 = 7#DEFINE ”Ø◊œÃ∆1 = 8#DEFINE ”Ø◊œÃ∆2 = 9#DEFINE ”Ø◊œÃ∆3 = 10#DEFINE ”Ø◊œÃ∆4 = 11#DEFINE ”Ø«…“Ã = 12' SEAM TITLE SPRITES#DEFINE ”Ø√»¡“Ø” = 0#DEFINE ”Ø√»¡“Ø– = 1#DEFINE ”Ø√»¡“Ø“ = 2#DEFINE ”Ø√»¡“Ø… = 3#DEFINE ”Ø√»¡“ØŒ = 4#DEFINE ”Ø√»¡“Ø« = 5#DEFINE √ÕƒØÃœœ– = -3SPRØCOUNT = ”–“ØÕ¡ÿ + 1TITLEØCOUNT = 6TRAP RUNSTOPØTRAPPER'----.MAIN'----  GOSUB INIT  DO WHILE 1    GOSUB TITLEØSCREEN    GOSUB MAINØGAME  LOOP  END'--------------------.PARSEØCURRENTØSEQPTR'--------------------  RET% = 0  IF PLYPTR = -1 THEN RET%=1:RETURN  IF RPLAY(1)<>0 THEN RET%=1:RETURN  K = SEQØCHUNK(PLYPTR)    IF K >= 0 THEN BEGIN    CHUNKØIDX = K    IF CHUNKØRPT <= 0 THEN CHUNKØRPT = SEQØEXTRA(PLYPTR)    GOSUB PLAYØCHUNKØIDX    PLAYIDX% = PLAYIDX% + 1    RET% = 1  BEND  PLYPTR = PLYPTR + 1  IF K = √ÕƒØÃœœ– THEN PLYPTR = 0  IF PLYPTR >= SEQCNT THEN PLYFLAG = 0 : PLYPTR = -1  RETURN'--------------.PLAYØCHUNKØIDX'--------------  PLAY V$(0, CHUNKØIDX), V$(1, CHUNKØIDX), V$(2, CHUNKØIDX), _       V$(3, CHUNKØIDX), V$(4, CHUNKØIDX), V$(5, CHUNKØIDX)  RETURN'-----.BOING'-----  SOUND SNDØORDER(SNDØIDX), 20000, 10, 0, 100, 1000, 1  SNDØIDX = MOD(SNDØIDX + 1, 6)  RETURN'------------------.STAGEØGAMEØOBJECTS'------------------  GOSUB PREPAREØINTERFACEØVARSØFORØGAME  FOR SIDX = 0 TO SPRØCOUNT - 1    GOSUB STAGEØOBJECT    GOSUB PARSEØCURRENTØSEQPTR  NEXT SIDX  SIDX = 0  RETURN'-------------------.STAGEØTITLEØOBJECTS'-------------------  GOSUB PREPAREØINTERFACEØVARSØFORØTITLE  FOR SIDX = 0 TO TITLEØCOUNT - 1    GOSUB STAGEØTITLEØOBJECT    IF INITIALØRUN = 0 THEN GOSUB PARSEØCURRENTØSEQPTR  NEXT SIDX  INITIALØRUN = 0  SIDX = 0  RETURN'------------.TITLEØSCREEN'------------  GOSUB CLRSCREEN  GOSUB STAGEØTITLEØOBJECTS  VOL 10, 10  TCLR = 0 : TX = 0 : TY = 12  A$ = "¡ GAME MADE BY ÕOANA (AND HER DADDY) IN 2025"  GOSUB DRAWØTEXTØCENTRED  TY = TY + 2 : A$ = "ÕADE USING ≈LEVEN + ¬¡”…√ 65 + '”≈¡ÕÃ…¬' LIBRARY."  GOSUB DRAWØTEXTØCENTRED  TCLR = 14 + $40  TY = TY + 3 : A$ = " OYSTICK PORT 2"  GOSUB DRAWØTEXTØCENTRED  TCLR = 0 + $80  ' $80 = UNDERLINE  TY = TY + 3 : A$ = "√HOOSE LEVEL OF DIFFICULTY:"  GOSUB DRAWØTEXTØCENTRED  TY = TY + 2  TMP = TY  A$ = À≈ŸØ“≈÷ØœŒ + "                     "  FOR K = 0 TO 10    TCLR = 0    TX = 29    GOSUB DRAWØTEXT    TX = 80    GX = 29 * 8    GOSUB DRAWØGOTOXØCHAR    TX = 102    GX = 640    GOSUB DRAWØGOTOXØCHAR    TY = TY +1  NEXT K  TCLR = 10 + $40  TX = 81  TY = TMP + 1  A$ = "  (1) ≈ASY"  GOSUB DRAWØTEXT  TCLR = 6 + $40  TY = TY + 2 : A$ = "  (2) ÕEDIUM"  GOSUB DRAWØTEXT  TCLR = 3 + $40  TY = TY + 2 : A$ = "  (3) ƒIFFICULT"  GOSUB DRAWØTEXT  TCLR = 0 + $40  TY = TY + 2 : A$ = "  (4) ≈XTREME"  GOSUB DRAWØTEXT  TCLR = 13 + $40  TY = TY + 2 : A$ = "  (ÿ) ≈XIT TO ¬¡”…√"  GOSUB DRAWØTEXT  TCLR = 0 + $80  ' $80 = UNDERLINE  TX = 7  TY = TY + 2 : A$ = "…NSTRUCTIONS:"  GOSUB DRAWØTEXT  TCLR = 0  TY = TY + 2  A$ = "- ŒAVIGATE YOUR CUTE HERO, ”PRING, TO AVOID THE BADDIE WOLVES"  GOSUB DRAWØTEXT  TY = TY + 1  A$ = "- ’SE KEY TO UNLOCK THE CHEST TO COLLECT GEMS"  GOSUB DRAWØTEXT  TY = TY + 1  A$ = "- ≈AT BANANAS TO KEEP YOUR HEALTH UP"  GOSUB DRAWØTEXT  TY = TY + 1  A$ = "- ƒRINK WATER TO PREVENT DEHYDRATION"  GOSUB DRAWØTEXT  TY = TY + 1  A$ = "- ’SE MAGIC CARPET TO FLY AROUND FASTER AND KILL BADDIES"  GOSUB DRAWØTEXT  TY = TY + 3  TX = 2  A$ = "- ‘HE SONG IS «URCE'S COVER OF THE 'ƒUNGEON OF THE ¡LGEBRA ƒRAGONS' THEME"  GOSUB DRAWØTEXT  TY = TY + 2  A$ = "- √ONSIDER SUPPORTING ÕOANA AND HER DADDY'S GAMES WITH A DONATION HERE:"  GOSUB DRAWØTEXT  TY = TY + 2  TCLR = 3  A$ = "  - HTTPS://PAYPAL.ME/GURCEI"  GOSUB DRAWØTEXT  TY = TY + 2  A$ = "  - HTTPS://PATREON.COM/GURCE"  GOSUB DRAWØTEXT  TCLR = 0  K = FRE(1)  ' GARBAGE COLLECT  TX = 50  DR = 2  DO WHILE 1    GET A$    IF A$ = "1" THEN WOLFØCNT = 0 : EXIT    IF A$ = "2" THEN WOLFØCNT = 1 : EXIT    IF A$ = "3" THEN WOLFØCNT = 2 : EXIT    IF A$ = "4" THEN WOLFØCNT = 3 : EXIT    IF A$ = "X" OR A$ = À≈ŸØÕ≈«¡Ø— THEN GOTO CLEANUP    GOSUB ANIMATEØTITLE    GOSUB PARSEØCURRENTØSEQPTR  LOOP  GOSUB CLRSCREEN  GOSUB RESTOREØDEFAULTØCOLOURS  RETURN'-------------.ANIMATEØTITLE'-------------  FOR K = 0 TO TITLEØCOUNT - 1    TITLEØOX%(”Ø√»¡“Ø” + K) = TX + K * 45    TITLEØOY%(”Ø√»¡“Ø” + K) = 40 - 30 * ABS(SIN(2 * TI + K * .6))  NEXT K  TX = TX + DR  IF TX > 360 THEN DR = -DR : TX = 360  IF TX < 10 THEN DR = -DR : TX = 10  GOSUB DRAWØOBJECTS  GOSUB CYCLEØCOLOURS  RETURN'-------------------------------.PREPAREØINTERFACEØVARSØFORØGAME'-------------------------------  ' PREPARE INTERFACE VARS FOR ASSEMBLY  BANK 0  WPOKE $7E00, POINTER(SPRØOX%(0))  WPOKE $7E02, POINTER(SPRØOY%(0))  WPOKE $7E04, POINTER(SPRØCHRØWIDTH%(0))  WPOKE $7E06, POINTER(SPRØCHRØHEIGHT%(0))  WPOKE $7E08, POINTER(SPRØCHARØIDX%(0))  WPOKE $7E0A, POINTER(STAGEØXØOFFS%(0))  POKE $7E0C, SPRØCOUNT  WPOKE $7E1A, POINTER(SPRØFIDX&(0))  WPOKE $7E1C, POINTER(SPRØFRAMES&(0,0))  WPOKE $7E1E, POINTER(BBØCNT&(0))  WPOKE $7E20, POINTER(BBØTLX&(0,0))  WPOKE $7E22, POINTER(BBØTLY&(0,0))  WPOKE $7E24, POINTER(BBØBRX&(0,0))  WPOKE $7E26, POINTER(BBØBRY&(0,0))  WPOKE $7E28, POINTER(SPRØCOLLIDE&(0,0))  BANK 128  RETURN'--------------------------------.PREPAREØINTERFACEØVARSØFORØTITLE'--------------------------------  BANK 0  WPOKE $7E00, POINTER(TITLEØOX%(0))  WPOKE $7E02, POINTER(TITLEØOY%(0))  WPOKE $7E04, POINTER(TITLEØCHRØWIDTH%(0))  WPOKE $7E06, POINTER(TITLEØCHRØHEIGHT%(0))  WPOKE $7E08, POINTER(TITLEØCHARØIDX%(0))  WPOKE $7E0A, POINTER(TITLEØSTAGEØXØOFFS%(0))  POKE $7E0C, TITLEØCOUNT  BANK 128  RETURN'------------------------.LOADØCURRENTØHIGHØSCORES'------------------------  DOPEN #2, "SCORES", R, U8  FOR K = 0 TO 3    INPUT #2, HSØNAME$(K)    INPUT #2, HSØSCORE(K)  NEXT K  DCLOSE #2  RETURN'----.INIT'----  PRINT CHR$(14);  ' LOWER-CASE  PRINT "ÃOADING GAME..."  BANK 0  BLOAD "GAME.PAL",P($FFD3100)  BLOAD "CHARS.BIN",P($40000),R  LN$ = "MOANA4.BIN"  GOSUB LOADØDATA  BLOAD "ASMHELPER"  BANK 128  KEY OFF  GOSUB LOADØCURRENTØHIGHØSCORES  INITIALØRUN = 1  SONG$ = "DRAGON.P"  GOSUB LOADØSONG  GOSUB STOREØDEFAULTØCOLOURS  APTRØLO = POINTER(A$) AND $FF  APTRØHI = POINTER(A$) / 256  ' PREPARE TITLE DETAILS  FOR K = 0 TO TITLEØCOUNT - 1    TITLEØCHRØWIDTH%(”Ø√»¡“Ø” + K) = 5    TITLEØCHRØHEIGHT%(”Ø√»¡“Ø” + K) = 5    TITLEØCHARØIDX%(”Ø√»¡“Ø” + K) = CHARØIDX%(∆Ø√»¡“Ø” + K)  NEXT K  ' PREPARE SPRITE DETAILS  SPRØCHRØWIDTH%(”Ø√¡“–≈‘) = 3  SPRØCHRØHEIGHT%(”Ø√¡“–≈‘) = 3  SPRØCHARØIDX%(”Ø√¡“–≈‘) = CHARØIDX%(∆Ø√¡“–≈‘)  SPRØFRAMEØCOUNT%(”Ø√¡“–≈‘) = 1  SPRØFRAMES&(”Ø√¡“–≈‘, 0) = ∆Ø√¡“–≈‘  SPRØCHRØWIDTH%(”ØÀ≈Ÿ) = 1  SPRØCHRØHEIGHT%(”ØÀ≈Ÿ) = 1  SPRØCHARØIDX%(”ØÀ≈Ÿ) = CHARØIDX%(∆ØÀ≈Ÿ)  SPRØFRAMEØCOUNT%(”ØÀ≈Ÿ) = 1  SPRØFRAMES&(”ØÀ≈Ÿ, 0) = ∆ØÀ≈Ÿ  SPRØCHRØWIDTH%(”Ø¬¡Œ¡Œ¡) = 2  SPRØCHRØHEIGHT%(”Ø¬¡Œ¡Œ¡) = 2  SPRØCHARØIDX%(”Ø¬¡Œ¡Œ¡) = CHARØIDX%(∆Ø¬¡Œ¡Œ¡)  SPRØFRAMEØCOUNT%(”Ø¬¡Œ¡Œ¡) = 1  SPRØFRAMES&(”Ø¬¡Œ¡Œ¡, 0) = ∆Ø¬¡Œ¡Œ¡  SPRØCHRØWIDTH%(”Ø◊¬œ‘‘Ã≈) = 3  SPRØCHRØHEIGHT%(”Ø◊¬œ‘‘Ã≈) = 3  SPRØCHARØIDX%(”Ø◊¬œ‘‘Ã≈) = CHARØIDX%(∆Ø◊¬œ‘‘Ã≈)  SPRØFRAMEØCOUNT%(”Ø◊¬œ‘‘Ã≈) = 1  SPRØFRAMES&(”Ø◊¬œ‘‘Ã≈, 0) = ∆Ø◊¬œ‘‘Ã≈#DEFINE ◊œÃ∆ØÕ¡ÿ = 3  FOR K = 0 TO ◊œÃ∆ØÕ¡ÿ    SPRØCHRØWIDTH%(”Ø◊œÃ∆1 + K) = 4    SPRØCHRØHEIGHT%(”Ø◊œÃ∆1 + K) = 4    SPRØCHARØIDX%(”Ø◊œÃ∆1 + K) = CHARØIDX%(∆Ø◊œÃ∆1)    SPRØFRAMEØCOUNT%(”Ø◊œÃ∆1 + K) = 2    SPRØFRAMES&(”Ø◊œÃ∆1 + K, 0) = ∆Ø◊œÃ∆1    SPRØFRAMES&(”Ø◊œÃ∆1 + K, 1) = ∆Ø◊œÃ∆2  NEXT K  SPRØCHRØWIDTH%(”Ø«…“Ã) = 4  SPRØCHRØHEIGHT%(”Ø«…“Ã) = 4  SPRØCHARØIDX%(”Ø«…“Ã) = CHARØIDX%(∆Ø«…“Ã1)  SPRØFRAMEØCOUNT%(”Ø«…“Ã) = 2  SPRØFRAMES&(”Ø«…“Ã, 0) = ∆Ø«…“Ã1  SPRØFRAMES&(”Ø«…“Ã, 1) = ∆Ø«…“Ã2  SPRØCHRØWIDTH%(”Ø√»≈”‘) = 4  SPRØCHRØHEIGHT%(”Ø√»≈”‘) = 4  SPRØCHARØIDX%(”Ø√»≈”‘) = CHARØIDX%(∆Ø√»≈”‘1)  SPRØFRAMEØCOUNT%(”Ø√»≈”‘) = 2  SPRØFRAMES&(”Ø√»≈”‘, 0) = ∆Ø√»≈”‘1  SPRØFRAMES&(”Ø√»≈”‘, 1) = ∆Ø√»≈”‘2  SPRØCHRØWIDTH%(”Ø«≈Õ1) = 2  SPRØCHRØHEIGHT%(”Ø«≈Õ1) = 2  SPRØCHARØIDX%(”Ø«≈Õ1) = CHARØIDX%(∆Ø«≈Õ1)  SPRØFRAMEØCOUNT%(”Ø«≈Õ1) = 1  SPRØFRAMES&(”Ø«≈Õ1, 0) = ∆Ø«≈Õ1  SPRØCHRØWIDTH%(”Ø«≈Õ2) = 2  SPRØCHRØHEIGHT%(”Ø«≈Õ2) = 2  SPRØCHARØIDX%(”Ø«≈Õ2) = CHARØIDX%(∆Ø«≈Õ2)  SPRØFRAMEØCOUNT%(”Ø«≈Õ2) = 1  SPRØFRAMES&(”Ø«≈Õ2, 0) = ∆Ø«≈Õ2  SPRØCHRØWIDTH%(”Ø«≈Õ3) = 2  SPRØCHRØHEIGHT%(”Ø«≈Õ3) = 2  SPRØCHARØIDX%(”Ø«≈Õ3) = CHARØIDX%(∆Ø«≈Õ3)  SPRØFRAMEØCOUNT%(”Ø«≈Õ3) = 1  SPRØFRAMES&(”Ø«≈Õ3, 0) = ∆Ø«≈Õ3      ' KEEP ALL SPRITES OFF-SCREEN TO START WITH  ' THAT'S MY SIMPLE WORKAROUND FOR NOW TO MAKE THEM 'INVISIBLE'  FOR K = 0 TO SPRØCOUNT - 1    SPRØOX%(K) = 640    SPRØOY%(K) = 10 * 8  NEXT K  ' HARD-CODING A FEW VALUES THAT WILL BE VARIABLE IN FUTURE  FIDX = 0  OLDYY = …Œ÷¡Ã…ƒ  PRINT "ì";À≈ŸØ≈”√¡–≈;"5";  BKPØD051& = PEEK($D051)    BKPØD054& = PEEK($D054)  BKPØD058& = PEEK($D058)  BKPØD059& = PEEK($D059)  BKPØD05E& = PEEK($D05E)  ' CLEAR Œœ““ƒ≈Ã: WHEN CLEAR, DOUBLE-BUFFERING IS USED  CLRBIT $D051, 7  ' SET ”≈¡Õ MODE √»“16 + ∆√Ã“»…  SETBIT $D054, 0  SETBIT $D054, 2  WPOKE $D058, ◊…ƒ‘»  POKE $D05E, ◊…ƒ‘» / 2  POKE $D021, 14  POKE $D020, 0  SNDØORDER(0) = 1  SNDØORDER(1) = 4  SNDØORDER(2) = 2  SNDØORDER(3) = 5  SNDØORDER(4) = 3  SNDØORDER(5) = 6  RETURN'---------------.RUNSTOPØTRAPPER'---------------  ' IF ER<>30 THEN RESUME  ' IGNORE EVERYTHING EXCEPT RUN/STOP  MYØERR$ = "?" + ERR$(ER) + " IN LINE " + STR$(EL).CLEANUP  PRINT "ì";MYØERR$  TRAP  GOSUB DOØCLEANUP  END'----------.DOØCLEANUP'----------  BANK 128  POKE $D051, BKPØD051&  POKE $D054, BKPØD054&  POKE $D058, BKPØD058&  POKE $D059, BKPØD059&  POKE $D05E, BKPØD05E&  KEY ON  PLAY  RETURN'---------.CLRSCREEN'---------  BANK 0  SYS $7F06  BANK 128  RETURN'------------.STAGEØOBJECT'------------  IF SIDX > 0 THEN BEGIN    STAGEØXØOFFS%(SIDX) = STAGEØXØOFFS%(SIDX-1) + SPRØCHRØWIDTH%(SIDX-1) + 1  BEND  FOR Y = 0 TO 49    ' PREPARE INITIAL GOTOX CHAR    POKE $FF80000 + Y * ◊…ƒ‘» + 160 + STAGEØXØOFFS%(SIDX) * 2, %10010000    WPOKE $40800 + Y * ◊…ƒ‘» + 160 + STAGEØXØOFFS%(SIDX) * 2, 80 * 8  ' KEEP OFF-SCREEN INITIALLY    ' PREPARE ENDING GOTOX CHAR    POKE $FF80000 + Y * ◊…ƒ‘» + 160 + STAGEØXØOFFS%(SIDX) * 2 + (SPRØCHRØWIDTH%(SIDX) + 1) * 2, %10010000    WPOKE $40800 + Y * ◊…ƒ‘» + 160 + STAGEØXØOFFS%(SIDX) * 2 + (SPRØCHRØWIDTH%(SIDX) + 1) * 2, 80 * 8  NEXT Y  RETURN'---------------.DRAWØGOTOXØCHAR'---------------  ' PREPARE INITIAL GOTOX CHAR  POKE $FF80000 + TY * ◊…ƒ‘» + TX * 2, %10010000  WPOKE $40800 + TY * ◊…ƒ‘» + TX * 2, GX  RETURN'------------------.STAGEØTITLEØOBJECT'------------------  IF SIDX > 0 THEN BEGIN    TITLEØSTAGEØXØOFFS%(SIDX) = _      TITLEØSTAGEØXØOFFS%(SIDX-1) + TITLEØCHRØWIDTH%(SIDX-1) + 1  BEND  FOR Y = 0 TO 15    ' PREPARE INITIAL GOTOX CHAR    POKE $FF80000 + Y * ◊…ƒ‘» + 160 + TITLEØSTAGEØXØOFFS%(SIDX) * 2, %10010000    WPOKE $40800 + Y * ◊…ƒ‘» + 160 + TITLEØSTAGEØXØOFFS%(SIDX) * 2, 80 * 8  ' KEEP OFF-SCREEN INITIALLY    ' PREPARE ENDING GOTOX CHAR    POKE $FF80000 + Y * ◊…ƒ‘» + 160 + TITLEØSTAGEØXØOFFS%(SIDX) * 2 + (TITLEØCHRØWIDTH%(SIDX) + 1) * 2, %10010000    WPOKE $40800 + Y * ◊…ƒ‘» + 160 + TITLEØSTAGEØXØOFFS%(SIDX) * 2 + (TITLEØCHRØWIDTH%(SIDX) + 1) * 2, 80 * 8  NEXT Y  RETURN'-------------.CHECKØHISCORE'-------------  IF SCORE >= HSØSCORE(WOLFØCNT) THEN BEGIN    BANK 0 : POKE $1600, ASC("H"), ASC("S")    A$ = STR$(SCORE)    FOR K = 0 TO LEN(A$)-1      POKE $1602 + K, ASC(MID$(A$,K+1,1))    NEXT K    POKE $1602 + LEN(A$), 0    GOSUB CLRSCREEN    GOSUB DOØCLEANUP    DLOAD "HISCORE"  BEND  RETURN'---------.MAINØGAME'---------  GOSUB STAGEØGAMEØOBJECTS  SCORE = 0 : HEALTH = 10 : WATER = 20  GOSUB DRAWØSCORE  GOSUB DRAWØHISCORE  GOSUB DRAWØENERGYØBARS  ' LOWER MUSIC VOLUME, BUT RAISE SOUND EFFECT VOLUME  VOL 5, 5  ' FOR MUSIC  POKE $FFD3458, $7  ' ”…ƒ3 @ $ƒ440  POKE $FFD3418, $7  ' ”…ƒ1 @ $ƒ400  ' FOR SOUND  POKE $FFD3478, $F  ' ”…ƒ4 @ $ƒ460  POKE $FFD3438, $F  ' ”…ƒ2 @ $ƒ420  GOSUB INITØLEVEL  K = FRE(1)  ' DO GARBAGE COLLECTION AFTER ANY STRING WORK  DO WHILE GAMEØOVERØFLAG = 0    ' GOSUB DRAWØCOORDS    GOSUB USERØINPUT    GOSUB BADDIEØLOGIC    GOSUB DRAWØOBJECTS    GOSUB ANIMATEØOBJECTS    GOSUB CHECKØBOXØCOLLISIONS    GOSUB GAMEØLOGIC    GOSUB PARSEØCURRENTØSEQPTR  LOOP  GOSUB CHECKØHISCORE  RETURN'----------.GAMEØLOGIC'----------  FOR WIDX = 0 TO WOLFØCNT    IF SPRØCOLLIDE&(”Ø«…“Ã, ”Ø◊œÃ∆1 + WIDX) <> 0 THEN GOSUB HANDLEØWOLFØCOLLISION  NEXT WIDX  IF SPRØCOLLIDE&(”Ø«…“Ã, ”ØÀ≈Ÿ) <> 0 THEN GOSUB HANDLEØKEYØCOLLISION  IF SPRØCOLLIDE&(”Ø«…“Ã, ”Ø¬¡Œ¡Œ¡) <> 0 THEN GOSUB HANDLEØBANANAØCOLLISION  IF SPRØCOLLIDE&(”Ø«…“Ã, ”Ø◊¬œ‘‘Ã≈) <> 0 THEN GOSUB HANDLEØWBOTTLEØCOLLISION  IF SPRØCOLLIDE&(”Ø«…“Ã, ”Ø√¡“–≈‘) <> 0 THEN GOSUB HANDLEØCARPETØCOLLISION  IF SPRØCOLLIDE&(”Ø«…“Ã, ”Ø√»≈”‘) <> 0 THEN GOSUB HANDLEØCHESTØCOLLISION  IF COLOURØCYCLEØFLAG = 1 THEN GOSUB HANDLEØCOLOURØCYCLING  IF KEYØFLAG >= 2 THEN GOSUB HANDLEØCHESTØVISIBILITY  IF MOD(ITER, 25) = 0 THEN GOSUB HANDLEØWATERØDROP  ITER = ITER + 1  RETURN'-----------------.HANDLEØWATERØDROP'-----------------  WATER = WATER - 1  GOSUB DRAWØENERGYØBARS  IF WATER = 0 THEN BEGIN    COLOURØCYCLEØFLAG = 0    GOSUB RESTOREØDEFAULTØCOLOURS    GOSUB CLRSCREEN    TCLR = 2 : A$ = "ŸOU DIED OF DEHYDRATION!"    PANEØWIDTH% = LEN(A$) + 4    PANEØHEIGHT% = 5    GOSUB SHOWØCENTREDØPANE    ' SLEEP TWO SECS WITH MUSIC POLLING    ENDØTIME = TI    DO WHILE (TI - ENDØTIME) < 2      GOSUB PARSEØCURRENTØSEQPTR    LOOP    ' CLEAR KEYBOARD BUFFER    FOR K = 0 TO 16      GET A$    NEXT K                GAMEØOVERØFLAG = 1  BEND  RETURN'-----------------------.HANDLEØCHESTØVISIBILITY'-----------------------  IF (TI - CHESTØTIME) > 5 AND SPRØOX%(”Ø√»≈”‘) <> 640 THEN BEGIN    SPRØOX%(”Ø√»≈”‘) = 640    SPRØFIDX&(”Ø√»≈”‘) = 0    TMP = CHARØIDX%(SPRØFRAMES&(”Ø√»≈”‘, 0))    SPRØCHARØIDX%(”Ø√»≈”‘) = TMP  BEND  IF GEMØX(0) = 640 AND GEMØX(1) = 640 AND GEMØX(2) = 640 THEN BEGIN    KEYØFLAG = 0    SIDX = ”ØÀ≈Ÿ    GOSUB SPAWNØITEM    SPRØFIDX&(”Ø√»≈”‘) = 0    TMP = CHARØIDX%(SPRØFRAMES&(”Ø√»≈”‘, 0))    SPRØCHARØIDX%(”Ø√»≈”‘) = TMP    SIDX = ”Ø√»≈”‘    GOSUB SPAWNØITEM    RETURN  BEND    ' ANIMATE GEMS  IF KEYØFLAG < 50 THEN BEGIN    KEYØFLAG = KEYØFLAG + 1    FOR K = 0 TO 2      IF GEMØX(K) <> 640 THEN BEGIN        GEMØX(K) = GEMØX(K) + GEMØVX(K)        IF GEMØX(K) < 1 THEN GEMØX(K) = 1 : GOSUB BOING : GEMØVX(K) = -GEMØVX(K)        IF GEMØX(K) > 623 THEN GEMØX(K) = 623 : GOSUB BOING : GEMØVX(K) = -GEMØVX(K)        GEMØY(K) = GEMØY(K) + GEMØVY(K)        IF GEMØY(K) < 16 THEN GEMØY(K) = 16 : GOSUB BOING : GEMØVY(K) = -GEMØVY(K)        IF GEMØY(K) > 383 THEN GEMØY(K) = 383 : GOSUB BOING : GEMØVY(K) = -GEMØVY(K)        SPRØOX%(”Ø«≈Õ1 + K) = GEMØX(K)        SPRØOY%(”Ø«≈Õ1 + K) = GEMØY(K)        GEMØVX(K) = .97 * GEMØVX(K)        GEMØVY(K) = .97 * GEMØVY(K)      BEND    NEXT K  BEND  IF KEYØFLAG > 15 THEN BEGIN    IF SPRØCOLLIDE&(”Ø«…“Ã, ”Ø«≈Õ1) THEN BEGIN      GEMØX(0) = 640 : SPRØOX%(”Ø«≈Õ1) = 640      SCORE = SCORE + 2000      GOSUB DRAWØSCORE      K = FRE(1)      SOUND SNDØORDER(SNDØIDX), 14000, 5, 0, 8000, 800, 2      SNDØIDX = MOD(SNDØIDX + 1, 6)    BEND    IF SPRØCOLLIDE&(”Ø«…“Ã, ”Ø«≈Õ2) THEN BEGIN      GEMØX(1) = 640 : SPRØOX%(”Ø«≈Õ2) = 640      SCORE = SCORE + 2000      GOSUB DRAWØSCORE      K = FRE(1)      SOUND SNDØORDER(SNDØIDX), 14000, 5, 0, 8000, 800, 2      SNDØIDX = MOD(SNDØIDX + 1, 6)    BEND    IF SPRØCOLLIDE&(”Ø«…“Ã, ”Ø«≈Õ3) THEN BEGIN      GEMØX(2) = 640 : SPRØOX%(”Ø«≈Õ3) = 640      SCORE = SCORE + 2000      GOSUB DRAWØSCORE      K = FRE(1)      SOUND SNDØORDER(SNDØIDX), 14000, 5, 0, 8000, 800, 2      SNDØIDX = MOD(SNDØIDX + 1, 6)    BEND  BEND  RETURN'----------------------.HANDLEØCHESTØCOLLISION'----------------------  IF KEYØFLAG = 1 THEN BEGIN    SOUND SNDØORDER(SNDØIDX), 5000, 10, 02, 3000, 500, 1    SNDØIDX = MOD(SNDØIDX + 1, 6)    KEYØFLAG = 2    CHESTØTIME = TI    SPRØFIDX&(”Ø√»≈”‘) = 1    TMP = CHARØIDX%(SPRØFRAMES&(”Ø√»≈”‘, 1))    SPRØCHARØIDX%(”Ø√»≈”‘) = TMP    FOR K = 0 TO 2      TMP = RND(1) * 3.14159 + 3.14159      GEMØVX(K) = 5 * COS(TMP)      GEMØVY(K) = 5 * SIN(TMP)      GEMØX(K) = SPRØOX%(”Ø√»≈”‘) + 5 * (K + 1)      GEMØY(K) = SPRØOY%(”Ø√»≈”‘)      SPRØOX%(”Ø«≈Õ1 + K) = GEMØX(K)      SPRØOY%(”Ø«≈Õ1 + K) = GEMØY(K)    NEXT K  BEND  RETURN'---------------------.HANDLEØCOLOURØCYCLING'---------------------  GOSUB CYCLEØCOLOURS  IF (TI - CYCLEØSTART) > CARPETØTIME THEN BEGIN    COLOURØCYCLEØFLAG = 0    GOSUB RESTOREØDEFAULTØCOLOURS    SIDX = ”Ø√¡“–≈‘    GOSUB SPAWNØITEM  BEND : ELSE BEGIN  SPRØOX%(”Ø√¡“–≈‘) = SPRØOX%(”Ø«…“Ã) + 16  SPRØOY%(”Ø√¡“–≈‘) = SPRØOY%(”Ø«…“Ã) + 8  BEND  RETURN'-------------.CYCLEØCOLOURS'-------------  BANK 0  SYS $7F21, $0A * 16, 16  BANK 128  RETURN'-----------------------.HANDLEØCARPETØCOLLISION'-----------------------  IF COLOURØCYCLEØFLAG = 0 THEN BEGIN    COLOURØCYCLEØFLAG = 1    CYCLEØSTART = TI    GIRLØVX = 0    GIRLØVY = 0    SOUND SNDØORDER(SNDØIDX), 4000, 50, 2, 2000, 200, 0    SNDØIDX = MOD(SNDØIDX + 1, 6)  BEND  RETURN'------------------------.HANDLEØWBOTTLEØCOLLISION'------------------------  SCORE = SCORE + 400  WATER = WATER + 8  GOSUB DRAWØSCORE  GOSUB DRAWØENERGYØBARS  K = FRE(1)  ' DO GARBAGE COLLECTION AFTER ANY STRING WORK  SOUND SNDØORDER(SNDØIDX), 5000, 30, 0, 1000, 600, 3  SNDØIDX = MOD(SNDØIDX + 1, 6)  SIDX = ”Ø◊¬œ‘‘Ã≈  GOSUB SPAWNØITEM  RETURN'-----------------------.HANDLEØBANANAØCOLLISION'-----------------------  SCORE = SCORE + 200  HEALTH = HEALTH + 2  GOSUB DRAWØSCORE  GOSUB DRAWØENERGYØBARS  K = FRE(1)  ' DO GARBAGE COLLECTION AFTER ANY STRING WORK  SOUND SNDØORDER(SNDØIDX), 1000, 20, 1, 500, 50, 3  SNDØIDX = MOD(SNDØIDX + 1, 6)  SIDX = ”Ø¬¡Œ¡Œ¡  GOSUB SPAWNØITEM  RETURN'--------------------.HANDLEØKEYØCOLLISION'--------------------  SCORE = SCORE + 100  GOSUB DRAWØSCORE  K = FRE(1)  ' DO GARBAGE COLLECTION AFTER ANY STRING WORK  SOUND SNDØORDER(SNDØIDX), 5000, 10, 0, 3000, 200, 1  SNDØIDX = MOD(SNDØIDX + 1, 6)  KEYØFLAG = 1  SPRØOX%(”ØÀ≈Ÿ) = 640  ' WORKAROUND TO HIDE  RETURN'---------------------.HANDLEØWOLFØCOLLISION'---------------------  IF COLOURØCYCLEØFLAG = 1 THEN BEGIN    SOUND SNDØORDER(SNDØIDX), 5000, 43, 0, 400, 500, 1    SNDØIDX = MOD(SNDØIDX + 1, 6)    SCORE = SCORE + 1000    GOSUB DRAWØSCORE    K = FRE(1)    SPRØOX%(”Ø◊œÃ∆1 + WIDX) = 640    WOLFØDIE(WIDX) = TI  BEND : ELSE BEGIN    HEALTH = HEALTH - 1    GOSUB DRAWØENERGYØBARS    K = FRE(1)    SOUND SNDØORDER(SNDØIDX), 1000, 5, 2, 3000, 500, 1    SNDØIDX = MOD(SNDØIDX + 1, 6)    IF HEALTH = 0 THEN BEGIN      COLOURØCYCLEØFLAG = 0      GOSUB RESTOREØDEFAULTØCOLOURS      GOSUB CLRSCREEN      TCLR = 2 : A$ = "ŸOU DIED A GRUESOME DEATH!"      PANEØWIDTH% = LEN(A$) + 4      PANEØHEIGHT% = 5      GOSUB SHOWØCENTREDØPANE      ' SLEEP TWO SECS WITH MUSIC POLLING      ENDØTIME = TI      DO WHILE (TI - ENDØTIME) < 2        GOSUB PARSEØCURRENTØSEQPTR      LOOP      ' CLEAR KEYBOARD BUFFER      FOR K = 0 TO 16        GET A$      NEXT K                  GAMEØOVERØFLAG = 1    BEND  BEND  RETURN'-----------------.SHOWØCENTREDØPANE'-----------------  PANEØX% = (80 - PANEØWIDTH%) / 2  PANEØY% = (50 - PANEØHEIGHT%) / 2  GOSUB DRAWØPANE  TCLR = 0 : TX = PANEØX% + 2 : TY = PANEØY% + 2  GOSUB DRAWØTEXT  RETURN'---------.DRAWØPANE'---------  BANK 0  POKE $7E10, PANEØX%  POKE $7E11, PANEØY%  POKE $7E12, PANEØWIDTH%  POKE $7E13, PANEØHEIGHT%  SYS $7F09  BANK 128  RETURN'---------.HIDEØPANE'---------  BANK 0  POKE $7E10, PANEØX%  POKE $7E11, PANEØY%  POKE $7E12, PANEØWIDTH%  POKE $7E13, PANEØHEIGHT%  SYS $7F0C  BANK 128  RETURN'----------.INITØLEVEL'----------  ITER = 0  WOLFØSPEED = .1 + WOLFØCNT / 10  CARPETØTIME = 10 + WOLFØCNT * 3  SPRØOX%(”Ø«…“Ã) = 310  SPRØOY%(”Ø«…“Ã) = 220  FOR K = 0 TO ◊œÃ∆ØÕ¡ÿ    WOLFØX(K) = 100 + 400 * MOD(K, 2)    WOLFØY(K) = 100 + 200 * INT(K / 2)    IF K <= WOLFØCNT THEN BEGIN      SPRØOX%(”Ø◊œÃ∆1 + K) = WOLFØX(K)      SPRØOY%(”Ø◊œÃ∆1 + K) = WOLFØY(K)    BEND: ELSE BEGIN      SPRØOX%(”Ø◊œÃ∆1 + K) = 640      SPRØOY%(”Ø◊œÃ∆1 + K) = 0    BEND    WOLFØVX(K) = 0    WOLFØVY(K) = 0  NEXT K  SPRØFIDX&(”Ø√»≈”‘) = 0  TMP = CHARØIDX%(SPRØFRAMES&(”Ø√»≈”‘, 0))  SPRØCHARØIDX%(”Ø√»≈”‘) = TMP  GAMEØOVERØFLAG = 0  COLOURØCYCLEØFLAG = 0  SIDX = ”ØÀ≈Ÿ  GOSUB SPAWNØITEM  SIDX = ”Ø¬¡Œ¡Œ¡  GOSUB SPAWNØITEM  SIDX = ”Ø◊¬œ‘‘Ã≈  GOSUB SPAWNØITEM  SIDX = ”Ø√¡“–≈‘  GOSUB SPAWNØITEM  SIDX = ”Ø√»≈”‘  GOSUB SPAWNØITEM  KEYØFLAG = 0  FOR K = 0 TO 3    WOLFØDIE(K) = 0  NEXT K  FOR K = 0 TO 2    GEMØX(K) = 640    SPRØOX%(”Ø«≈Õ1 + K) = 640  NEXT K  RETURN'----------.SPAWNØITEM'----------  SPRØOX%(SIDX) = RND(1)*580 + 10  SPRØOY%(SIDX) = 32 +RND(1)*340  GOSUB CHECKØBOXØCOLLISIONS  IF SPRØCOLLIDE&(”Ø«…“Ã, SIDX) <> 0 THEN GOTO SPAWNØITEM  RETURN'------------.BADDIEØLOGIC'------------  FOR WIDX = 0 TO WOLFØCNT    IF WOLFØDIE(WIDX) <> 0 THEN BEGIN      IF (TI - WOLFØDIE(WIDX)) > 10 THEN BEGIN        SIDX = ”Ø◊œÃ∆1 + WIDX        GOSUB SPAWNØITEM        WOLFØX(WIDX) = SPRØOX%(”Ø◊œÃ∆1 + WIDX)        WOLFØY(WIDX) = SPRØOY%(”Ø◊œÃ∆1 + WIDX)        WOLFØVX(WIDX) = 0        WOLFØVY(WIDX) = 0        WOLFØDIE(WIDX) = 0      BEND    BEND    IF WOLFØDIE(WIDX) <> 0 THEN GOTO CNTØWIDX    DX = SPRØOX%(”Ø«…“Ã) - SPRØOX%(”Ø◊œÃ∆1 + WIDX)    DY = SPRØOY%(”Ø«…“Ã) - SPRØOY%(”Ø◊œÃ∆1 + WIDX)    RADIUS = SQR(DX*DX + DY*DY)    IF DX <> 0 THEN DX = WOLFØSPEED * DX / RADIUS ' : ELSE WOLFØVX(WIDX) = 0    IF DY <> 0 THEN DY = WOLFØSPEED * DY / RADIUS ' : ELSE WOLFØVY(WIDX) = 0    IF COLOURØCYCLEØFLAG = 0 THEN BEGIN      WOLFØVX(WIDX) = WOLFØVX(WIDX) + DX      WOLFØVY(WIDX) = WOLFØVY(WIDX) + DY    BEND : ELSE : BEGIN      WOLFØVX(WIDX) = WOLFØVX(WIDX) - DX      WOLFØVY(WIDX) = WOLFØVY(WIDX) - DY    BEND    IF WOLFØVX(WIDX) > 5+WIDX THEN WOLFØVX(WIDX) = 5+WIDX    IF WOLFØVX(WIDX) < -5-WIDX THEN WOLFØVX(WIDX) = -5-WIDX    IF WOLFØVY(WIDX) > 5+WIDX THEN WOLFØVY(WIDX) = 5+WIDX    IF WOLFØVY(WIDX) < -5-WIDX THEN WOLFØVY(WIDX) = -5-WIDX    WOLFØX(WIDX) = WOLFØX(WIDX) + WOLFØVX(WIDX)    WOLFØY(WIDX) = WOLFØY(WIDX) + WOLFØVY(WIDX)    IF WOLFØX(WIDX) < 0 THEN WOLFØX(WIDX) = 0 : GOSUB BOING : WOLFØVX(WIDX) = -WOLFØVX(WIDX)    IF WOLFØX(WIDX) > 607 THEN WOLFØX(WIDX) = 607 : GOSUB BOING : WOLFØVX(WIDX) = -WOLFØVX(WIDX)    IF WOLFØY(WIDX) < 0 THEN WOLFØY(WIDX) = 0 : GOSUB BOING : WOLFØVY(WIDX) = -WOLFØVY(WIDX)    IF WOLFØY(WIDX) > 367 THEN WOLFØY(WIDX) = 367 : GOSUB BOING : WOLFØVY(WIDX) = -WOLFØVY(WIDX)    SPRØOX%(”Ø◊œÃ∆1 + WIDX) = WOLFØX(WIDX)    SPRØOY%(”Ø◊œÃ∆1 + WIDX) = WOLFØY(WIDX).CNTØWIDX  NEXT WIDX  RETURN'----------.USERØINPUT'----------  GET A$  BANK 128 : JVAL = PEEK($DC00)  IF COLOURØCYCLEØFLAG = 1 THEN GOSUB CARPETØCONTROLS    IF COLOURØCYCLEØFLAG = 0 THEN GOSUB NORMALØCONTROLS      IF A$ = À≈ŸØÕ≈«¡Ø— THEN GOTO CLEANUP  RETURN'---------------.CARPETØCONTROLS'---------------  IF (NOT JVAL AND 4) AND GIRLØVX > -5 THEN BEGIN    GIRLØVX = GIRLØVX - 1  BEND  IF (NOT JVAL AND 8) AND GIRLØVX < 5 THEN BEGIN    GIRLØVX = GIRLØVX + 1  BEND  IF (NOT JVAL AND 1) AND GIRLØVY > -5 THEN BEGIN    GIRLØVY = GIRLØVY - 1  BEND  IF (NOT JVAL AND 2) AND GIRLØVY < 5 THEN BEGIN    GIRLØVY = GIRLØVY + 1  BEND  SPRØOX%(”Ø«…“Ã) = SPRØOX%(”Ø«…“Ã) + GIRLØVX  IF SPRØOX%(”Ø«…“Ã) < 0 THEN SPRØOX%(”Ø«…“Ã) = 0 : GOSUB BOING : GIRLØVX = -GIRLØVX  IF SPRØOX%(”Ø«…“Ã) > 607 THEN SPRØOX%(”Ø«…“Ã) = 607 : GOSUB BOING : GIRLØVX = -GIRLØVX  SPRØOY%(”Ø«…“Ã) = SPRØOY%(”Ø«…“Ã) + GIRLØVY  IF SPRØOY%(”Ø«…“Ã) < 16 THEN SPRØOY%(”Ø«…“Ã) = 16: GOSUB BOING : GIRLØVY = -GIRLØVY  IF SPRØOY%(”Ø«…“Ã) > 367 THEN SPRØOY%(”Ø«…“Ã) = 367 : GOSUB BOING : GIRLØVY = -GIRLØVY  RETURN'---------------.NORMALØCONTROLS'---------------  IF (NOT JVAL AND 4) THEN BEGIN    SPRØOX%(”Ø«…“Ã) = SPRØOX%(”Ø«…“Ã) - 3    IF SPRØOX%(”Ø«…“Ã) < 0 THEN SPRØOX%(”Ø«…“Ã) = 0  BEND  IF (NOT JVAL AND 8) THEN BEGIN    SPRØOX%(”Ø«…“Ã) = SPRØOX%(”Ø«…“Ã) + 3    IF SPRØOX%(”Ø«…“Ã) > 607 THEN SPRØOX%(”Ø«…“Ã) = 607  BEND  IF (NOT JVAL AND 1) THEN BEGIN    SPRØOY%(”Ø«…“Ã) = SPRØOY%(”Ø«…“Ã) - 3    IF SPRØOY%(”Ø«…“Ã) < 16 THEN SPRØOY%(”Ø«…“Ã) = 16  BEND  IF (NOT JVAL AND 2) THEN BEGIN    SPRØOY%(”Ø«…“Ã) = SPRØOY%(”Ø«…“Ã) + 3    IF SPRØOY%(”Ø«…“Ã) > 367 THEN SPRØOY%(”Ø«…“Ã) = 367  BEND  RETURN  '----------.DRAWØSCORE'----------  TX = 0 : TY = 0 : TCLR = 0  A$ = "”√œ“≈: " + STR$(SCORE)  GOSUB DRAWØTEXT  RETURN'------------.DRAWØHISCORE'------------  TX = 40 : TY = 0 : TCLR = 0  A$ = HSØNAME$(WOLFØCNT) + "'S »…«» ”√œ“≈: " + STR$(HSØSCORE(WOLFØCNT))  K = FRE(1)  GOSUB DRAWØTEXT  RETURN'----------------.DRAWØENERGYØBARS'----------------  TX = 0 : TY = 1 : TCLR = 0  A$ = "»≈¡Ã‘»: "  GOSUB DRAWØTEXT  TX = 8 : TCLR = 5  A$ = À≈ŸØ“≈÷ØœŒ  IF HEALTH > 0 THEN BEGIN    IF HEALTH > 30 THEN HEALTH = 30    FOR K = 0 TO HEALTH - 1      A$ = A$ + " "    NEXT K  BEND  A$ = A$ + À≈ŸØ“≈÷Øœ∆∆ + " "  GOSUB DRAWØTEXT  ' - - - - - - -  TX = 40 : TY = 1 : TCLR = 0  A$ = "◊¡‘≈“: "  GOSUB DRAWØTEXT  TX = 48 : TCLR = 6  A$ = À≈ŸØ“≈÷ØœŒ  IF WATER > 0 THEN BEGIN    IF WATER > 30 THEN WATER = 30    FOR K = 0 TO WATER - 1      A$ = A$ + " "    NEXT K  BEND  A$ = A$ + À≈ŸØ“≈÷Øœ∆∆ + " "  GOSUB DRAWØTEXT  RETURN'---------------.ANIMATEØOBJECTS'---------------  ANIMØTMR = MOD (ANIMØTMR + 1, 8)  IF ANIMØTMR = 0 THEN BEGIN    FOR K = 0 TO WOLFØCNT      FIDX = SPRØFIDX&(”Ø◊œÃ∆1 + K)      FIDX = MOD(FIDX + 1, 2)      SPRØFIDX&(”Ø◊œÃ∆1 + K) = FIDX      TMP = CHARØIDX%(SPRØFRAMES&(”Ø◊œÃ∆1 + K, FIDX))      SPRØCHARØIDX%(”Ø◊œÃ∆1 + K) = TMP    NEXT K    FIDX = SPRØFIDX&(”Ø«…“Ã)    FIDX = MOD(FIDX + 1, 2)    SPRØFIDX&(”Ø«…“Ã) = FIDX    TMP = CHARØIDX%(SPRØFRAMES&(”Ø«…“Ã, FIDX))    SPRØCHARØIDX%(”Ø«…“Ã) = TMP  BEND  RETURN'-----------.DRAWØCOORDS'-----------  TCLR = 0 : TX = 5 : TY = 4  A$ = "SPRITE INDEX =" + STR$(SIDX)  GOSUB DRAWØTEXT  TCLR = 0 : TX = 5 : TY = 5  A$ = "X =" + STR$(SPRØOX%(SIDX)) + ", Y =" + STR$(SPRØOY%(SIDX)) + "     "    ' FORCE GARBAGE COLLECTION NOW, SO THAT IT DOESN'T TRIGGER  ' DURING SYS CALL AND CRASH (DUE TO MY √Ã“–‘“=$20 BEING A FAR-PTR IN BASIC)  K = FRE(1)  GOSUB DRAWØTEXT  RETURN'------------.DRAWØOBJECTS'------------  VSYNC 250'  BORDER 3  BANK 0  SYS $7F00  BANK 128  RETURN'--------------------.CHECKØBOXØCOLLISIONS'--------------------  ' BORDER 5  BANK 0  SYS $7F1E  BANK 128  ' BORDER 0  RETURN'-----------------.DRAWØTEXTØCENTRED'-----------------  TX = (80 - LEN(A$)) / 2  GOSUB DRAWØTEXT  RETURN'---------.DRAWØTEXT'---------  BANK 0  POKE $7E0D, TX  POKE $7E0E, TY  POKE $7E0F, TCLR  SYS $7F03, 0, APTRØLO, APTRØHI  BANK 128  RETURN  ' THE ABOVE WORKS, BUT OCCASIONALLY TRIPS UP ON BASIC GARBAGE COLLECTION'---------.LOADØDATA'---------  CHARØCOUNT = 0  IF LEN(LN$) > 0 THEN BEGIN    DOPEN #2,(LN$),R,U8    IF DS THEN TCLR = 2 : A$ = "DISK ERROR" : GOSUB DRAWØTEXT : RETURN    GET#2, FRAMEØCOUNT%    FOR K = 0 TO FRAMEØCOUNT% - 1      GET#2, XX : CHARØTYPE(K) = XX AND 255      GET#2, XX : DEFAULTØSLICE(K) = XX AND 255      GET#2, XX : CHRØWIDTH%(K) = XX AND 255      GET#2, XX : CHRØHEIGHT%(K) = XX AND 255      GET#2, XX, YY      CHARØIDX%(K) = (XX AND 255) + (YY AND 255) * 256      GET#2, XX : BBØCNT&(K) = XX AND 255      IF BBØCNT&(K) > 0 THEN BEGIN        FOR KK = 0 TO BBØCNT&(K) - 1          GET#2, XX, YY : BBØTLX&(K,KK) = XX AND 255 : BBØTLY&(K,KK) = YY AND 255          GET#2, XX, YY : BBØBRX&(K,KK) = XX AND 255 : BBØBRY&(K,KK) = YY AND 255        NEXT KK      BEND      CHARØCOUNT = CHARØCOUNT + CHRØWIDTH%(K) * CHRØHEIGHT%(K)    NEXT K    ' TODO : ADD ANIMATION DETAILS HERE    GET#2, XX : ANIMØCOUNT = XX AND 255    IF ANIMØCOUNT > 0 THEN BEGIN      FOR K = 0 TO ANIMØCOUNT - 1        ' LOAD NUMBER OF FRAMES IN ANIM        ' LOAD LIST OF FRAME INDICES      NEXT K    BEND    FOR K = 0 TO CHARØCOUNT * $40      GET#2, XX      POKE CHARØIDX%(0) * $40 + K, XX AND 255    NEXT K    DCLOSE #2    IF DEBUGØBB = 1 THEN GOSUB DRAWØBOUNDINGØBOXES  BEND  RETURN'-------------------.DRAWØBOUNDINGØBOXES'-------------------  FOR FIDX = 0 TO FRAMEØCOUNT% - 1    IF BBØCNT&(FIDX) > 0 THEN BEGIN      FOR K = 0 TO BBØCNT&(FIDX) - 1        FOR CX = BBØTLX&(FIDX, K) TO BBØBRX&(FIDX, K)          CY = BBØTLY&(FIDX, K)          GOSUB PLOTØPIXEL          CY = BBØBRY&(FIDX, K)          GOSUB PLOTØPIXEL        NEXT CX        FOR CY = BBØTLY&(FIDX, K) TO BBØBRY&(FIDX, K)          CX = BBØTLX&(FIDX, K)          GOSUB PLOTØPIXEL          CX = BBØBRX&(FIDX, K)          GOSUB PLOTØPIXEL        NEXT CY      NEXT K    BEND  NEXT FIDX  RETURN'----------.PLOTØPIXEL'----------  X = MOD(CX, 8)  Y = MOD(CY, 8)  XX = INT(CX / 8)  YY = INT(CY / 8)  POKE CHARØIDX%(FIDX) * $40 + $40 * CHRØHEIGHT%(FIDX) * XX + $40 * YY + Y * 8 + X, 1  RETURN'---------------------.STOREØDEFAULTØCOLOURS'---------------------  FOR K = 0 TO 15    DEFAULTØRED&(K) = PEEK($D1A0+K)    DEFAULTØGREEN&(K) = PEEK($D2A0+K)    DEFAULTØBLUE&(K) = PEEK($D3A0+K)  NEXT K  RETURN'-----------------------.RESTOREØDEFAULTØCOLOURS'-----------------------  FOR K = 0 TO 15    POKE $D1A0+K, DEFAULTØRED&(K)    POKE $D2A0+K, DEFAULTØGREEN&(K)    POKE $D3A0+K, DEFAULTØBLUE&(K)  NEXT K  RETURN'---------.LOADØSONG'---------  DOPEN #2,(SONG$),R,U8  ' LOAD MELODY CHUNKS  ' ------------------  INPUT #2, CHUNKØCNT  FOR CHUNKØIDX = 0 TO CHUNKØCNT - 1    FOR VIDX=0 TO 5      INPUT #2,V$(VIDX, CHUNKØIDX)    NEXT VIDX  NEXT CHUNKØIDX  INPUT #2,TMPO%  TEMPO TMPO%    ' LOAD ENVELOPES  ' --------------  FOR ROW = 0 TO 9    INPUT #2, TMP$    INPUT #2, ATTACK    INPUT #2, DECAY    INPUT #2, SUSTAIN    INPUT #2, RELEASE    INPUT #2, WAVEFORM    INPUT #2, PW    ENVELOPE ROW, ATTACK, DECAY, SUSTAIN, RELEASE, WAVEFORM, PW  NEXT ROW  PRINT  ' LOAD FILTER PRESETS  ' -------------------  FOR ROW = 0 TO 10    INPUT #2, TMP$    INPUT #2, TMP    INPUT #2, TMP    INPUT #2, TMP    INPUT #2, TMP    INPUT #2, TMP    INPUT #2, TMP    INPUT #2, TMP    INPUT #2, TMP  NEXT ROW  ' LOAD SEQUENCE  ' -------------  SEQCNT = 0  INPUT #2, SEQCNT  ROW = 0  DO WHILE ROW < SEQCNT    INPUT #2, SEQØCHUNK(ROW)    INPUT #2, SEQØEXTRA(ROW)    ROW = ROW + 1  LOOP  DCLOSE #2  CHUNKØIDX = 0  RETURN