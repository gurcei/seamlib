#OUTPUT "SEAMLIB"#DEFINE ”–“ØÕ¡ÿ = 13 - 1'--------.DECLARES'--------#DECLARE FIDX, FRAMEØCOUNT%, ANIMØCOUNT#DECLARE BKPØD054&, BKPØD058&, BKPØD059&, BKPØD05E&#DECLARE MYØERR$, K, IDX, X, Y, VALUE' FRAME DETAILS#DECLARE DEFAULTØSLICE(100), CHARØTYPE(100), CHARØIDX%(100)#DECLARE CHRØWIDTH%(100), CHRØHEIGHT%(100)#DECLARE BBØTLX&(100,10), BBØTLY&(100,10), BBØBRX&(100,10), BBØBRY&(100,10)#DECLARE BBØCNT&(100)#DECLARE OLDØFIDX' SPRITE DETAILS#DECLARE SPRØCHRØWIDTH%(100), SPRØCHRØHEIGHT%(100), SPRØCHARØIDX%(100)#DECLARE SPRØFRAMEØCOUNT%(100), SPRØFRAMES&(100,20), SPRØVISIBLE%(100)#DECLARE SPRØFIDX&(100), STAGEØXØOFFS%(100), SPRØCOUNT#DECLARE SPRØOX%(100), SPRØOY%(100)#DECLARE SPRØCOLLIDE&(”–“ØÕ¡ÿ ,”–“ØÕ¡ÿ)#DECLARE OBJX, OBJY, OLDYY, MINYY, MAXYY, YYBOT #DECLARE A$, YY, OFFSY, TMP, TMPX, TMPY#DECLARE TCLR, TX, TY, REVØFLAG, CHR#DECLARE LN$, CHARØCOUNT, XX, KK, SIDX, OLDØSIDX, ANIMØTMR#DECLARE CX, CY, SIDX2, OBJX2, OBJY2, K1, K2#DECLARE BOX1ØX1%, BOX1ØY1%, BOX1ØX2%, BOX1ØY2%#DECLARE BOX2ØX1%, BOX2ØY1%, BOX2ØX2%, BOX2ØY2%#DECLARE COLLISIONØFLAG, FIDX2#DECLARE APTRØLO, APTRØHI, SCORE, HEALTH, RADIUS#DECLARE WOLFØX(3), WOLFØY(3), WOLFØVX(3), WOLFØVY(3), DX, DY#DECLARE PANEØX%, PANEØY%, PANEØWIDTH%, PANEØHEIGHT%#DECLARE GAMEØOVERØFLAG#DECLARE CYCLEØSTART, COLOURØCYCLEØFLAG#DECLARE DEFAULTØRED&(32), DEFAULTØGREEN&(32), DEFAULTØBLUE&(32)#DECLARE GIRLØVX, GIRLØVY, WOLFØDIE(3)#DECLARE DEBUGØBB = 0'-------.DEFINES'-------#DEFINE À≈ŸØ≈”√¡–≈ = CHR$(27)#DEFINE À≈ŸØ“≈÷ØœŒ = ""#DEFINE À≈ŸØ“≈÷Øœ∆∆ = "í"#DEFINE À≈ŸØ’– = "ë"#DEFINE À≈ŸØƒœ◊Œ = ""#DEFINE À≈ŸØÃ≈∆‘ = "ù"#DEFINE À≈ŸØ“…«»‘ = ""#DEFINE À≈ŸØÕ≈«¡Ø— = "´"#DEFINE ◊…ƒ‘» = 300#DEFINE œ–Ø√œ–Ÿ = 0#DEFINE œ–ØÕ…ÿ  = 1#DEFINE œ–Ø”◊¡– = 2#DEFINE œ–Ø∆…ÃÃ = 3#DEFINE …Œ÷¡Ã…ƒ = -666' SEAM FRAMES#DEFINE ∆Ø√¡“–≈‘ = 0#DEFINE ∆Ø◊œÃ∆1 = 1#DEFINE ∆ØÀ≈Ÿ = 2#DEFINE ∆Ø¬¡Œ¡Œ¡ = 3#DEFINE ∆Ø◊¬œ‘‘Ã≈ = 4#DEFINE ∆Ø◊œÃ∆2 = 5#DEFINE ∆Ø«…“Ã1 = 6#DEFINE ∆Ø«…“Ã2 = 7#DEFINE ∆Ø√»≈”‘2 = 8#DEFINE ∆Ø√»≈”‘1 = 9#DEFINE ∆Ø«≈Õ1 = 10#DEFINE ∆Ø«≈Õ2 = 11#DEFINE ∆Ø«≈Õ3 = 12#DEFINE ∆Ø√»¡“Ø” = 13#DEFINE ∆Ø√»¡“Ø– = 14#DEFINE ∆Ø√»¡“Ø“ = 15#DEFINE ∆Ø√»¡“Ø… = 16#DEFINE ∆Ø√»¡“ØŒ = 17#DEFINE ∆Ø√»¡“Ø« = 18' SEAM SPRITES#DEFINE ”Ø√¡“–≈‘ = 0#DEFINE ”ØÀ≈Ÿ = 1#DEFINE ”Ø¬¡Œ¡Œ¡ = 2#DEFINE ”Ø◊¬œ‘‘Ã≈ = 3#DEFINE ”Ø◊œÃ∆1 = 4#DEFINE ”Ø◊œÃ∆2 = 5#DEFINE ”Ø◊œÃ∆3 = 6#DEFINE ”Ø◊œÃ∆4 = 7#DEFINE ”Ø«…“Ã = 8#DEFINE ”Ø√»≈”‘ = 9#DEFINE ”Ø«≈Õ1 = 10#DEFINE ”Ø«≈Õ2 = 11#DEFINE ”Ø«≈Õ3 = 12SPRØCOUNT = ”–“ØÕ¡ÿ + 1TRAP RUNSTOPØTRAPPER'----.MAIN'----  GOSUB INIT  DO WHILE 1    GOSUB TITLEØSCREEN    FOR SIDX = 0 TO SPRØCOUNT - 1      GOSUB STAGEØOBJECT    NEXT SIDX    SIDX = 0    GOSUB MAINØGAME  LOOP  END'------------.TITLEØSCREEN'------------  GOSUB CLRSCREEN  TCLR = 0 : TX = 0 : TY = 0  A$ = "======"  GOSUB DRAWØTEXT  TY = TY + 1 : A$ = "”–“…Œ«"  GOSUB DRAWØTEXT  TY = TY + 1 : A$ = "======  ¡ GAME BY ÕOANA AND «URCE"  GOSUB DRAWØTEXT  TY = TY + 2 : A$ = "ÕADE USING THE 'SEAMLIB' LIBRARY."  GOSUB DRAWØTEXT  TY = TY +2 : A$ = " OYSTICK PORT 2"  GOSUB DRAWØTEXT  TY = TY + 2 : A$ = "–RESS ANY KEY TO START"  GOSUB DRAWØTEXT  K = FRE(1)  ' GARBAGE COLLECT  GET KEY A$  GOSUB CLRSCREEN  RETURN'----.INIT'----  BANK 0  BLOAD "GAME.PAL",P($FFD3100)  BLOAD "CHARS.BIN",P($40000),R  LN$ = "MOANA4.BIN"  GOSUB LOADØDATA  BLOAD "ASMHELPER"  BANK 128  KEY OFF  PRINT CHR$(14);  ' LOWER-CASE  GOSUB STOREØDEFAULTØCOLOURS  APTRØLO = POINTER(A$) AND $FF  APTRØHI = POINTER(A$) / 256  ' PREPARE INTERFACE VARS FOR ASSEMBLY  BANK 0  WPOKE $7E00, POINTER(SPRØOX%(0))  WPOKE $7E02, POINTER(SPRØOY%(0))  WPOKE $7E04, POINTER(SPRØCHRØWIDTH%(0))  WPOKE $7E06, POINTER(SPRØCHRØHEIGHT%(0))  WPOKE $7E08, POINTER(SPRØCHARØIDX%(0))  WPOKE $7E0A, POINTER(STAGEØXØOFFS%(0))  POKE $7E0C, SPRØCOUNT  WPOKE $7E1A, POINTER(SPRØFIDX&(0))  WPOKE $7E1C, POINTER(SPRØFRAMES&(0,0))  WPOKE $7E1E, POINTER(BBØCNT&(0))  WPOKE $7E20, POINTER(BBØTLX&(0,0))  WPOKE $7E22, POINTER(BBØTLY&(0,0))  WPOKE $7E24, POINTER(BBØBRX&(0,0))  WPOKE $7E26, POINTER(BBØBRY&(0,0))  WPOKE $7E28, POINTER(SPRØCOLLIDE&(0,0))  BANK 128  ' PREPARE SPRITE DETAILS  SPRØCHRØWIDTH%(”Ø√¡“–≈‘) = 3  SPRØCHRØHEIGHT%(”Ø√¡“–≈‘) = 3  SPRØCHARØIDX%(”Ø√¡“–≈‘) = CHARØIDX%(∆Ø√¡“–≈‘)  SPRØFRAMEØCOUNT%(”Ø√¡“–≈‘) = 1  SPRØFRAMES&(”Ø√¡“–≈‘, 0) = ∆Ø√¡“–≈‘  SPRØCHRØWIDTH%(”ØÀ≈Ÿ) = 1  SPRØCHRØHEIGHT%(”ØÀ≈Ÿ) = 1  SPRØCHARØIDX%(”ØÀ≈Ÿ) = CHARØIDX%(∆ØÀ≈Ÿ)  SPRØFRAMEØCOUNT%(”ØÀ≈Ÿ) = 1  SPRØFRAMES&(”ØÀ≈Ÿ, 0) = ∆ØÀ≈Ÿ  SPRØCHRØWIDTH%(”Ø¬¡Œ¡Œ¡) = 2  SPRØCHRØHEIGHT%(”Ø¬¡Œ¡Œ¡) = 2  SPRØCHARØIDX%(”Ø¬¡Œ¡Œ¡) = CHARØIDX%(∆Ø¬¡Œ¡Œ¡)  SPRØFRAMEØCOUNT%(”Ø¬¡Œ¡Œ¡) = 1  SPRØFRAMES&(”Ø¬¡Œ¡Œ¡, 0) = ∆Ø¬¡Œ¡Œ¡  SPRØCHRØWIDTH%(”Ø◊¬œ‘‘Ã≈) = 3  SPRØCHRØHEIGHT%(”Ø◊¬œ‘‘Ã≈) = 3  SPRØCHARØIDX%(”Ø◊¬œ‘‘Ã≈) = CHARØIDX%(∆Ø◊¬œ‘‘Ã≈)  SPRØFRAMEØCOUNT%(”Ø◊¬œ‘‘Ã≈) = 1  SPRØFRAMES&(”Ø◊¬œ‘‘Ã≈, 0) = ∆Ø◊¬œ‘‘Ã≈  FOR K = 0 TO 3    SPRØCHRØWIDTH%(”Ø◊œÃ∆1 + K) = 4    SPRØCHRØHEIGHT%(”Ø◊œÃ∆1 + K) = 4    SPRØCHARØIDX%(”Ø◊œÃ∆1 + K) = CHARØIDX%(∆Ø◊œÃ∆1)    SPRØFRAMEØCOUNT%(”Ø◊œÃ∆1 + K) = 2    SPRØFRAMES&(”Ø◊œÃ∆1 + K, 0) = ∆Ø◊œÃ∆1    SPRØFRAMES&(”Ø◊œÃ∆1 + K, 1) = ∆Ø◊œÃ∆2  NEXT K  SPRØCHRØWIDTH%(”Ø«…“Ã) = 4  SPRØCHRØHEIGHT%(”Ø«…“Ã) = 4  SPRØCHARØIDX%(”Ø«…“Ã) = CHARØIDX%(∆Ø«…“Ã1)  SPRØFRAMEØCOUNT%(”Ø«…“Ã) = 2  SPRØFRAMES&(”Ø«…“Ã, 0) = ∆Ø«…“Ã1  SPRØFRAMES&(”Ø«…“Ã, 1) = ∆Ø«…“Ã2  SPRØCHRØWIDTH%(”Ø√»≈”‘) = 4  SPRØCHRØHEIGHT%(”Ø√»≈”‘) = 4  SPRØCHARØIDX%(”Ø√»≈”‘) = CHARØIDX%(∆Ø√»≈”‘1)  SPRØFRAMEØCOUNT%(”Ø√»≈”‘) = 2  SPRØFRAMES&(”Ø√»≈”‘, 0) = ∆Ø√»≈”‘1  SPRØFRAMES&(”Ø√»≈”‘, 1) = ∆Ø√»≈”‘2  SPRØCHRØWIDTH%(”Ø«≈Õ1) = 2  SPRØCHRØHEIGHT%(”Ø«≈Õ1) = 2  SPRØCHARØIDX%(”Ø«≈Õ1) = CHARØIDX%(∆Ø«≈Õ1)  SPRØFRAMEØCOUNT%(”Ø«≈Õ1) = 1  SPRØFRAMES&(”Ø«≈Õ1, 0) = ∆Ø«≈Õ1  SPRØCHRØWIDTH%(”Ø«≈Õ2) = 2  SPRØCHRØHEIGHT%(”Ø«≈Õ2) = 2  SPRØCHARØIDX%(”Ø«≈Õ2) = CHARØIDX%(∆Ø«≈Õ2)  SPRØFRAMEØCOUNT%(”Ø«≈Õ2) = 1  SPRØFRAMES&(”Ø«≈Õ2, 0) = ∆Ø«≈Õ2  SPRØCHRØWIDTH%(”Ø«≈Õ3) = 2  SPRØCHRØHEIGHT%(”Ø«≈Õ3) = 2  SPRØCHARØIDX%(”Ø«≈Õ3) = CHARØIDX%(∆Ø«≈Õ3)  SPRØFRAMEØCOUNT%(”Ø«≈Õ3) = 1  SPRØFRAMES&(”Ø«≈Õ3, 0) = ∆Ø«≈Õ3      ' KEEP ALL SPRITES OFF-SCREEN TO START WITH  ' THAT'S MY SIMPLE WORKAROUND FOR NOW TO MAKE THEM 'INVISIBLE'  FOR K = 0 TO SPRØCOUNT - 1    SPRØOX%(K) = 640    SPRØOY%(K) = 10 * 8  NEXT K  ' HARD-CODING A FEW VALUES THAT WILL BE VARIABLE IN FUTURE  FIDX = 0  OLDYY = …Œ÷¡Ã…ƒ  PRINT "ì";À≈ŸØ≈”√¡–≈;"5";    BKPØD054& = PEEK($D054)  BKPØD058& = PEEK($D058)  BKPØD059& = PEEK($D059)  BKPØD05E& = PEEK($D05E)  ' SET ”≈¡Õ MODE √»“16 + ∆√Ã“»…  SETBIT $D054, 0  SETBIT $D054, 2  WPOKE $D058, ◊…ƒ‘»  POKE $D05E, ◊…ƒ‘» / 2  POKE $D021, 14  POKE $D020, 0  RETURN'---------------.RUNSTOPØTRAPPER'---------------  ' IF ER<>30 THEN RESUME  ' IGNORE EVERYTHING EXCEPT RUN/STOP  MYØERR$ = "?" + ERR$(ER) + " IN LINE " + STR$(EL).CLEANUP  PRINT "ì";MYØERR$  TRAP  POKE $D054, BKPØD054&  POKE $D058, BKPØD058&  POKE $D059, BKPØD059&  POKE $D05E, BKPØD05E&  KEY ON  END'---------.CLRSCREEN'---------  EDMA œ–Ø∆…ÃÃ, ◊…ƒ‘» * 50, 32, $40800  EDMA œ–Ø∆…ÃÃ, ◊…ƒ‘» * 50, 0, $FF80000  ' CLEAR SCREEN  FOR Y = 0 TO 49   FOR X = 0 TO 79     POKE $40800 + Y * ◊…ƒ‘» + X * 2 + 1, 0   NEXT X  NEXT Y  RETURN'------------.STAGEØOBJECT'------------  IF SIDX > 0 THEN BEGIN    STAGEØXØOFFS%(SIDX) = STAGEØXØOFFS%(SIDX-1) + SPRØCHRØWIDTH%(SIDX-1) + 1  BEND  FOR Y = 0 TO 49    ' PREPARE INITIAL GOTOX CHAR    POKE $FF80000 + Y * ◊…ƒ‘» + 160 + STAGEØXØOFFS%(SIDX) * 2, %10010000    WPOKE $40800 + Y * ◊…ƒ‘» + 160 + STAGEØXØOFFS%(SIDX) * 2, 80 * 8  ' KEEP OFF-SCREEN INITIALLY    ' PREPARE ENDING GOTOX CHAR    POKE $FF80000 + Y * ◊…ƒ‘» + 160 + STAGEØXØOFFS%(SIDX) * 2 + (SPRØCHRØWIDTH%(SIDX) + 1) * 2, %10010000    WPOKE $40800 + Y * ◊…ƒ‘» + 160 + STAGEØXØOFFS%(SIDX) * 2 + (SPRØCHRØWIDTH%(SIDX) + 1) * 2, 80 * 8  NEXT Y  ' GOSUB DRAWØOBJECT  RETURN'---------.MAINØGAME'---------  SCORE = 0 : HEALTH = 10  GOSUB DRAWØSCORE  GOSUB DRAWØENERGYØBARS  GOSUB INITØLEVEL  K = FRE(1)  ' DO GARBAGE COLLECTION AFTER ANY STRING WORK  DO WHILE GAMEØOVERØFLAG = 0    ' GOSUB DRAWØCOORDS    GOSUB USERØINPUT    GOSUB BADDIEØLOGIC    GOSUB DRAWØOBJECTS    GOSUB ANIMATEØOBJECTS    GOSUB CHECKØBOXØCOLLISIONS    GOSUB GAMEØLOGIC  LOOP  RETURN'----------.GAMEØLOGIC'----------  IF SPRØCOLLIDE&(”Ø«…“Ã, ”Ø◊œÃ∆1) <> 0 THEN GOSUB HANDLEØWOLFØCOLLISION  IF SPRØCOLLIDE&(”Ø«…“Ã, ”ØÀ≈Ÿ) <> 0 THEN GOSUB HANDLEØKEYØCOLLISION  IF SPRØCOLLIDE&(”Ø«…“Ã, ”Ø¬¡Œ¡Œ¡) <> 0 THEN GOSUB HANDLEØBANANAØCOLLISION  IF SPRØCOLLIDE&(”Ø«…“Ã, ”Ø◊¬œ‘‘Ã≈) <> 0 THEN GOSUB HANDLEØWBOTTLEØCOLLISION  IF SPRØCOLLIDE&(”Ø«…“Ã, ”Ø√¡“–≈‘) <> 0 THEN GOSUB HANDLEØCARPETØCOLLISION  IF COLOURØCYCLEØFLAG = 1 THEN GOSUB HANDLEØCOLOURØCYCLING  RETURN'---------------------.HANDLEØCOLOURØCYCLING'---------------------  BANK 0  SYS $7F21, 16  BANK 128  IF (TI - CYCLEØSTART) > 10 THEN BEGIN    COLOURØCYCLEØFLAG = 0    GOSUB RESTOREØDEFAULTØCOLOURS    SIDX = ”Ø√¡“–≈‘    GOSUB SPAWNØITEM  BEND : ELSE BEGIN  SPRØOX%(”Ø√¡“–≈‘) = SPRØOX%(”Ø«…“Ã) + 16  SPRØOY%(”Ø√¡“–≈‘) = SPRØOY%(”Ø«…“Ã) + 8  BEND  RETURN'-----------------------.HANDLEØCARPETØCOLLISION'-----------------------  IF COLOURØCYCLEØFLAG = 0 THEN BEGIN    COLOURØCYCLEØFLAG = 1    CYCLEØSTART = TI    GIRLØVX = 0    GIRLØVY = 0  BEND  RETURN'------------------------.HANDLEØWBOTTLEØCOLLISION'------------------------  SCORE = SCORE + 400  HEALTH = HEALTH + 4  GOSUB DRAWØSCORE  GOSUB DRAWØENERGYØBARS  K = FRE(1)  ' DO GARBAGE COLLECTION AFTER ANY STRING WORK  SIDX = ”Ø◊¬œ‘‘Ã≈  GOSUB SPAWNØITEM  RETURN'-----------------------.HANDLEØBANANAØCOLLISION'-----------------------  SCORE = SCORE + 200  HEALTH = HEALTH + 2  GOSUB DRAWØSCORE  GOSUB DRAWØENERGYØBARS  K = FRE(1)  ' DO GARBAGE COLLECTION AFTER ANY STRING WORK  SIDX = ”Ø¬¡Œ¡Œ¡  GOSUB SPAWNØITEM  RETURN'--------------------.HANDLEØKEYØCOLLISION'--------------------  SCORE = SCORE + 100  GOSUB DRAWØSCORE  K = FRE(1)  ' DO GARBAGE COLLECTION AFTER ANY STRING WORK  SIDX = ”ØÀ≈Ÿ  GOSUB SPAWNØITEM  RETURN'---------------------.HANDLEØWOLFØCOLLISION'---------------------  IF COLOURØCYCLEØFLAG = 1 THEN BEGIN    SCORE = SCORE + 1000    GOSUB DRAWØSCORE    K = FRE(1)    SPRØOX%(”Ø◊œÃ∆1) = 640    WOLFØDIE(0) = TI  BEND : ELSE BEGIN    HEALTH = HEALTH - 1    GOSUB DRAWØENERGYØBARS    K = FRE(1)    IF HEALTH = 0 THEN BEGIN      COLOURØCYCLEØFLAG = 0      GOSUB RESTOREØDEFAULTØCOLOURS      TCLR = 2 : A$ = "ŸOU DIED A GRUESOME DEATH!"      PANEØWIDTH% = LEN(A$) + 4      PANEØHEIGHT% = 5      GOSUB SHOWØCENTREDØPANE      SLEEP 2      ' CLEAR KEYBOARD BUFFER      FOR K = 0 TO 16        GET A$      NEXT K                  GAMEØOVERØFLAG = 1    BEND  BEND  RETURN'-----------------.SHOWØCENTREDØPANE'-----------------  PANEØX% = (80 - PANEØWIDTH%) / 2  PANEØY% = (50 - PANEØHEIGHT%) / 2  GOSUB DRAWØPANE  TCLR = 0 : TX = PANEØX% + 2 : TY = PANEØY% + 2  GOSUB DRAWØTEXT  RETURN'---------.DRAWØPANE'---------  BANK 0  POKE $7E10, PANEØX%  POKE $7E11, PANEØY%  POKE $7E12, PANEØWIDTH%  POKE $7E13, PANEØHEIGHT%^^  SYS TO $7F09, I0  BANK 128  RETURN'---------.HIDEØPANE'---------  BANK 0  POKE $7E10, PANEØX%  POKE $7E11, PANEØY%  POKE $7E12, PANEØWIDTH%  POKE $7E13, PANEØHEIGHT%^^  SYS TO $7F0C, I0  BANK 128  RETURN'----------.INITØLEVEL'----------  SPRØOX%(”Ø«…“Ã) = 30  SPRØOY%(”Ø«…“Ã) = 220  WOLFØX(0) = 600  WOLFØY(0) = 220  SPRØOX%(”Ø◊œÃ∆1) = WOLFØX(0)  SPRØOY%(”Ø◊œÃ∆1) = WOLFØY(0)  WOLFØVX(0) = 0  WOLFØVY(0) = 0  GAMEØOVERØFLAG = 0  COLOURØCYCLEØFLAG = 0  SIDX = ”ØÀ≈Ÿ  GOSUB SPAWNØITEM  SIDX = ”Ø¬¡Œ¡Œ¡  GOSUB SPAWNØITEM  SIDX = ”Ø◊¬œ‘‘Ã≈  GOSUB SPAWNØITEM  SIDX = ”Ø√¡“–≈‘  GOSUB SPAWNØITEM  FOR K = 0 TO 3    WOLFØDIE(K) = 0  NEXT K  RETURN'----------.SPAWNØITEM'----------  SPRØOX%(SIDX) = RND(1)*600  SPRØOY%(SIDX) = 32 +RND(1)*340  GOSUB CHECKØBOXØCOLLISIONS  IF SPRØCOLLIDE&(”Ø«…“Ã, SIDX) <> 0 THEN GOTO SPAWNØITEM  RETURN'------------.BADDIEØLOGIC'------------  IF WOLFØDIE(0) <> 0 THEN BEGIN    IF (TI - WOLFØDIE(0)) > 10 THEN BEGIN      SIDX = ”Ø◊œÃ∆1      GOSUB SPAWNØITEM      WOLFØX(0) = SPRØOX%(”Ø◊œÃ∆1)      WOLFØY(0) = SPRØOY%(”Ø◊œÃ∆1)      WOLFØVX(0) = 0      WOLFØVY(0) = 0      WOLFØDIE(0) = 0    BEND    RETURN  BEND  DX = SPRØOX%(”Ø«…“Ã) - SPRØOX%(”Ø◊œÃ∆1)  DY = SPRØOY%(”Ø«…“Ã) - SPRØOY%(”Ø◊œÃ∆1)  RADIUS = SQR(DX*DX + DY*DY)  IF DX <> 0 THEN DX = .1 * DX / RADIUS ' : ELSE WOLFØVX(0) = 0  IF DY <> 0 THEN DY = .1 * DY / RADIUS ' : ELSE WOLFØVY(0) = 0  IF COLOURØCYCLEØFLAG = 0 THEN BEGIN    WOLFØVX(0) = WOLFØVX(0) + DX    WOLFØVY(0) = WOLFØVY(0) + DY  BEND : ELSE : BEGIN    WOLFØVX(0) = WOLFØVX(0) - DX    WOLFØVY(0) = WOLFØVY(0) - DY  BEND  IF WOLFØVX(0) > 5 THEN WOLFØVX(0) = 5  IF WOLFØVX(0) < -5 THEN WOLFØVX(0) = -5  IF WOLFØVY(0) > 5 THEN WOLFØVY(0) = 5  IF WOLFØVY(0) < -5 THEN WOLFØVY(0) = -5  WOLFØX(0) = WOLFØX(0) + WOLFØVX(0)  WOLFØY(0) = WOLFØY(0) + WOLFØVY(0)  IF WOLFØX(0) < 0 THEN WOLFØX(0) = 0  IF WOLFØX(0) > 607 THEN WOLFØX(0) = 607  IF WOLFØY(0) < 0 THEN WOLFØY(0) = 0  IF WOLFØY(0) > 367 THEN WOLFØY(0) = 367  SPRØOX%(”Ø◊œÃ∆1) = WOLFØX(0)  SPRØOY%(”Ø◊œÃ∆1) = WOLFØY(0)  RETURN'----------.USERØINPUT'----------  GET A$  IF COLOURØCYCLEØFLAG = 1 THEN GOSUB CARPETØCONTROLS    IF COLOURØCYCLEØFLAG = 0 THEN GOSUB NORMALØCONTROLS      IF A$ = À≈ŸØÕ≈«¡Ø— THEN GOTO CLEANUP  RETURN'---------------.CARPETØCONTROLS'---------------  IF A$ = À≈ŸØÃ≈∆‘ AND GIRLØVX > -4 THEN BEGIN    GIRLØVX = GIRLØVX - 1  BEND  IF A$ = À≈ŸØ“…«»‘ AND GIRLØVX < 4 THEN BEGIN    GIRLØVX = GIRLØVX + 1  BEND  IF A$ = À≈ŸØ’– AND GIRLØVY > -4 THEN BEGIN    GIRLØVY = GIRLØVY - 1  BEND  IF A$ = À≈ŸØƒœ◊Œ AND GIRLØVY < 4 THEN BEGIN    GIRLØVY = GIRLØVY + 1  BEND  SPRØOX%(”Ø«…“Ã) = SPRØOX%(”Ø«…“Ã) + GIRLØVX  IF SPRØOX%(”Ø«…“Ã) < 0 THEN SPRØOX%(”Ø«…“Ã) = 0: GIRLØVX = -GIRLØVX  IF SPRØOX%(”Ø«…“Ã) > 607 THEN SPRØOX%(”Ø«…“Ã) = 607 : GIRLØVX = -GIRLØVX  SPRØOY%(”Ø«…“Ã) = SPRØOY%(”Ø«…“Ã) + GIRLØVY  IF SPRØOY%(”Ø«…“Ã) < 0 THEN SPRØOY%(”Ø«…“Ã) = 0: GIRLØVY = -GIRLØVY  IF SPRØOY%(”Ø«…“Ã) > 367 THEN SPRØOY%(”Ø«…“Ã) = 367 : GIRLØVY = -GIRLØVY  RETURN'---------------.NORMALØCONTROLS'---------------  IF A$ = À≈ŸØÃ≈∆‘ THEN BEGIN    SPRØOX%(”Ø«…“Ã) = SPRØOX%(”Ø«…“Ã) - 3    IF SPRØOX%(”Ø«…“Ã) < 0 THEN SPRØOX%(”Ø«…“Ã) = 0  BEND  IF A$ = À≈ŸØ“…«»‘ THEN BEGIN    SPRØOX%(”Ø«…“Ã) = SPRØOX%(”Ø«…“Ã) + 3    IF SPRØOX%(”Ø«…“Ã) > 607 THEN SPRØOX%(”Ø«…“Ã) = 607  BEND  IF A$ = À≈ŸØ’– THEN BEGIN    SPRØOY%(”Ø«…“Ã) = SPRØOY%(”Ø«…“Ã) - 3    IF SPRØOY%(”Ø«…“Ã) < 16 THEN SPRØOY%(”Ø«…“Ã) = 16  BEND  IF A$ = À≈ŸØƒœ◊Œ THEN BEGIN    SPRØOY%(”Ø«…“Ã) = SPRØOY%(”Ø«…“Ã) + 3    IF SPRØOY%(”Ø«…“Ã) > 367 THEN SPRØOY%(”Ø«…“Ã) = 367  BEND  RETURN'----------.DRAWØSCORE'----------  TX = 0 : TY = 0 : TCLR = 0  A$ = "”√œ“≈: " + STR$(SCORE)  GOSUB DRAWØTEXT  RETURN'----------------.DRAWØENERGYØBARS'----------------  TX = 0 : TY = 1 : TCLR = 0  A$ = "»≈¡Ã‘»: "  GOSUB DRAWØTEXT  TX = 8 : TCLR = 5  A$ = À≈ŸØ“≈÷ØœŒ  IF HEALTH > 0 THEN BEGIN    FOR K = 0 TO HEALTH - 1      A$ = A$ + " "    NEXT K  BEND  A$ = A$ + À≈ŸØ“≈÷Øœ∆∆ + " "  GOSUB DRAWØTEXT  RETURN'---------------.ANIMATEØOBJECTS'---------------  ANIMØTMR = MOD (ANIMØTMR + 1, 8)  IF ANIMØTMR = 0 THEN BEGIN    FOR K = 0 TO 3      FIDX = SPRØFIDX&(”Ø◊œÃ∆1 + K)      FIDX = MOD(FIDX + 1, 2)      SPRØFIDX&(”Ø◊œÃ∆1 + K) = FIDX      TMP = CHARØIDX%(SPRØFRAMES&(”Ø◊œÃ∆1 + K, FIDX))      SPRØCHARØIDX%(”Ø◊œÃ∆1 + K) = TMP    NEXT K    FIDX = SPRØFIDX&(”Ø«…“Ã)    FIDX = MOD(FIDX + 1, 2)    SPRØFIDX&(”Ø«…“Ã) = FIDX    TMP = CHARØIDX%(SPRØFRAMES&(”Ø«…“Ã, FIDX))    SPRØCHARØIDX%(”Ø«…“Ã) = TMP  BEND  RETURN'-----------.DRAWØCOORDS'-----------  TCLR = 0 : TX = 5 : TY = 4  A$ = "SPRITE INDEX =" + STR$(SIDX)  GOSUB DRAWØTEXT  TCLR = 0 : TX = 5 : TY = 5  A$ = "X =" + STR$(SPRØOX%(SIDX)) + ", Y =" + STR$(SPRØOY%(SIDX)) + "     "    ' FORCE GARBAGE COLLECTION NOW, SO THAT IT DOESN'T TRIGGER  ' DURING SYS CALL AND CRASH (DUE TO MY √Ã“–‘“=$20 BEING A FAR-PTR IN BASIC)  K = FRE(1)  GOSUB DRAWØTEXT  RETURN'------------.DRAWØOBJECTS'------------  VSYNC 250'  BORDER 3  BANK 0^^  SYS TO $7F00, I0  BANK 128  RETURN'--------------------.CHECKØBOXØCOLLISIONS'--------------------  ' BORDER 5  BANK 0  SYS $7F1E  BANK 128  ' BORDER 0  RETURN'---------.DRAWØTEXT'---------  BANK 0  POKE $7E0D, TX  POKE $7E0E, TY  POKE $7E0F, TCLR  SYS $7F03, 0, APTRØLO, APTRØHI  BANK 128  RETURN  ' THE ABOVE WORKS, BUT OCCASIONALLY TRIPS UP ON BASIC GARBAGE COLLECTION'---------.LOADØDATA'---------  CHARØCOUNT = 0  IF LEN(LN$) > 0 THEN BEGIN    DOPEN #2,(LN$),R,U8    IF DS THEN TCLR = 2 : A$ = "DISK ERROR" : GOSUB DRAWØTEXT : RETURN    GET#2, FRAMEØCOUNT%    FOR K = 0 TO FRAMEØCOUNT% - 1      GET#2, XX : CHARØTYPE(K) = XX AND 255      GET#2, XX : DEFAULTØSLICE(K) = XX AND 255      GET#2, XX : CHRØWIDTH%(K) = XX AND 255      GET#2, XX : CHRØHEIGHT%(K) = XX AND 255      GET#2, XX, YY      CHARØIDX%(K) = (XX AND 255) + (YY AND 255) * 256      GET#2, XX : BBØCNT&(K) = XX AND 255      IF BBØCNT&(K) > 0 THEN BEGIN        FOR KK = 0 TO BBØCNT&(K) - 1          GET#2, XX, YY : BBØTLX&(K,KK) = XX AND 255 : BBØTLY&(K,KK) = YY AND 255          GET#2, XX, YY : BBØBRX&(K,KK) = XX AND 255 : BBØBRY&(K,KK) = YY AND 255        NEXT KK      BEND      CHARØCOUNT = CHARØCOUNT + CHRØWIDTH%(K) * CHRØHEIGHT%(K)    NEXT K    ' TODO : ADD ANIMATION DETAILS HERE    GET#2, XX : ANIMØCOUNT = XX AND 255    IF ANIMØCOUNT > 0 THEN BEGIN      FOR K = 0 TO ANIMØCOUNT - 1        ' LOAD NUMBER OF FRAMES IN ANIM        ' LOAD LIST OF FRAME INDICES      NEXT K    BEND    FOR K = 0 TO CHARØCOUNT * $40      GET#2, XX      POKE CHARØIDX%(0) * $40 + K, XX AND 255    NEXT K    DCLOSE #2    IF DEBUGØBB = 1 THEN GOSUB DRAWØBOUNDINGØBOXES  BEND  RETURN'-------------------.DRAWØBOUNDINGØBOXES'-------------------  FOR FIDX = 0 TO FRAMEØCOUNT% - 1    IF BBØCNT&(FIDX) > 0 THEN BEGIN      FOR K = 0 TO BBØCNT&(FIDX) - 1        FOR CX = BBØTLX&(FIDX, K) TO BBØBRX&(FIDX, K)          CY = BBØTLY&(FIDX, K)          GOSUB PLOTØPIXEL          CY = BBØBRY&(FIDX, K)          GOSUB PLOTØPIXEL        NEXT CX        FOR CY = BBØTLY&(FIDX, K) TO BBØBRY&(FIDX, K)          CX = BBØTLX&(FIDX, K)          GOSUB PLOTØPIXEL          CX = BBØBRX&(FIDX, K)          GOSUB PLOTØPIXEL        NEXT CY      NEXT K    BEND  NEXT FIDX  RETURN'----------.PLOTØPIXEL'----------  X = MOD(CX, 8)  Y = MOD(CY, 8)  XX = INT(CX / 8)  YY = INT(CY / 8)  POKE CHARØIDX%(FIDX) * $40 + $40 * CHRØHEIGHT%(FIDX) * XX + $40 * YY + Y * 8 + X, 1  RETURN'---------------------.STOREØDEFAULTØCOLOURS'---------------------  FOR K = 0 TO 31    DEFAULTØRED&(K) = PEEK($D100+K)    DEFAULTØGREEN&(K) = PEEK($D200+K)    DEFAULTØBLUE&(K) = PEEK($D300+K)  NEXT K  RETURN'-----------------------.RESTOREØDEFAULTØCOLOURS'-----------------------  FOR K = 0 TO 31    POKE $D100+K, DEFAULTØRED&(K)    POKE $D200+K, DEFAULTØGREEN&(K)    POKE $D300+K, DEFAULTØBLUE&(K)  NEXT K  RETURN