#OUTPUT "HISCORE"CLR'--------.DECLARES'--------#DECLARE K, HSØNAME$(3), HSØSCORE(3), HSØLEVEL$(3), A$#DECLARE TX, TY, CHR, ADDR, X, Y, VL, XX, YY, Z, C$, TCLR#DECLARE IDX, LVLØCLR(3), CIDX, RAINBOWØFLAG#DECLARE DEFAULTØHSØRED&(32), DEFAULTØHSØGREEN&(32), DEFAULTØHSØBLUE&(32)#DECLARE TMR, CH, SCORE$#DECLARE CURSORØTMR, CURSORØTX, CURSORØSTATE, B$, NAME$, TMP.MUSICØVARS'----------#DEFINE CHUNKØMAX = 50#DECLARE CHUNKØCNT, CHUNKØIDX, VIDX, TMPO%, ROW#DECLARE ECHOØM, ECHOØB, ECHOØSZ = .05, CHUNKØRPT, ECHOØDELAY#DECLARE V$(5,CHUNKØMAX), V#DECLARE SONG$#DECLARE V1$, V2$, V3$, V4$, V5$, V6$#DECLARE CURRØFREQ, CURRØDIR#DECLARE SEQCNT#DECLARE SEQØCHUNK(200), SEQØEXTRA(200)#DECLARE PLYPTR, PLYFLAG, RET%, TMP$, PLAYIDX%#DECLARE ATTACK, DECAY, SUSTAIN, RELEASE, WAVEFORM, PW'-------.DEFINES'-------#DEFINE À≈ŸØ≈”√¡–≈ = CHR$(27)#DEFINE –Ãœ‘Ø–…ÿ≈Ã = $7F27#DEFINE À≈ŸØƒ≈Ã = ""#DEFINE À≈ŸØ“≈‘’“Œ = CHR$(13)#DEFINE √ÕƒØÃœœ– = -3'----.MAIN'----  GOSUB INIT  GOSUB LOADØCURRENTØHIGHØSCORES  GOSUB CHECKØIFØNEWØHIGHØSCORE  GOSUB DRAWØHISCOREØTITLE  GOSUB DRAWØHISCOREØLIST  TMR = TI  DO    GET A$    IF A$ = "Q" THEN EXIT    IF A$ <> "" THEN BEGIN      GOSUB RESTOREØDEFAULTØHSØCOLOURS      PRINT CHR$(147);      BANK 0 : POKE $1600, ASC("Z"), ASC("Z") : BANK 128      DLOAD "SEAMLIB"    BEND    IF TI - TMR > .1 THEN GOSUB CYCLEØHSØCOLOURS: TMR = TI    GOSUB PARSEØCURRENTØSEQPTR  LOOP  END'-----------------------.CHECKØIFØNEWØHIGHØSCORE'-----------------------  IF PEEK($1600) = ASC("H") AND PEEK($1601) = ASC("S") THEN BEGIN    POKE $1600, 0, 0    IDX = PEEK($1602)    A$ = ""    K = 0    DO      CH = PEEK($1603 + K)      IF CH = 0 THEN EXIT      A$ = A$ + CHR$(CH)      K = K + 1    LOOP    K = FRE(1)    SCORE$ = A$        TX = 0 : TY = 0 : TCLR = -1    A$ = "√ONGRATULATIONS!"    GOSUB PLOTØCENTREDØTEXT    TY = TY + 12 : TCLR = -1    A$ = "ŒEW »IGH ”CORE!"    GOSUB PLOTØCENTREDØTEXT    TX = 0 : TY = TY + 20 : TCLR = LVLØCLR(IDX)    A$ = HSØLEVEL$(IDX) + ": " + SCORE$    GOSUB PLOTØCENTREDØTEXT    TX = 0 : TY = TY + 20 : TCLR = 12    A$ = "≈NTER YOUR NAME:"    GOSUB PLOTØTEXT    TMR = TI    CURSORØTMR = TI - 1    CURSORØTX = 0    TY = TY + 8    CURSORØSTATE = 0    DO      GOSUB HANDLEØCURSOR      IF (TI - TMR) > .1 THEN BEGIN        GOSUB CYCLEØHSØCOLOURS        TMR = TI      BEND      GOSUB HANDLEØNAMEØINPUT      IF A$ = À≈ŸØ“≈‘’“Œ AND NAME$<>"" THEN EXIT    LOOP    PRINT CHR$(147);    HSØNAME$(IDX) = NAME$    HSØSCORE(IDX) = VAL(SCORE$)    GOSUB SAVEØHISCORES    DLOAD "HISCORE"  BEND  RETURN'-----------------.HANDLEØNAMEØINPUT'-----------------  GET A$  IF (A$ >= "A" AND A$ <= "Z") OR (A$ >= "¡" AND A$ <= "⁄") OR A$=" " THEN BEGIN    IF LEN(NAME$) < 12 THEN BEGIN      CURSORØSTATE = 0      GOSUB DRAWØCURSOR      TX = CURSORØTX      TCLR = CURSORØTX / 8 + $40      GOSUB PLOTØTEXT      CURSORØTX = CURSORØTX + 8      CURSORØTMR = TI - 1      NAME$ = NAME$ + A$    BEND  BEND  IF A$ = À≈ŸØƒ≈Ã AND CURSORØTX > 0 THEN BEGIN    CURSORØSTATE = 0    GOSUB DRAWØCURSOR    CURSORØTX = CURSORØTX - 8    GOSUB DRAWØCURSOR    CURSORØTMR = TI - 1    NAME$ = LEFT$(NAME$, LEN(NAME$) - 1)  BEND  GOSUB PARSEØCURRENTØSEQPTR  RETURN'-------------.HANDLEØCURSOR'-------------  IF (TI - CURSORØTMR) > .5 THEN BEGIN    CURSORØTMR = TI    IF CURSORØSTATE = 0 THEN BEGIN      CURSORØSTATE = 1    BEND: ELSE BEGIN      CURSORØSTATE = 0    BEND    GOSUB DRAWØCURSOR  BEND  RETURN'-----------.DRAWØCURSOR'-----------  B$ = "    "  IF CURSORØSTATE = 1 THEN B$ = "" + B$ : ELSE B$ = "í" + B$  X = CURSORØTX / 2  Y = TY / 2  COLOR CURSORØTX / 8 + 16  FOR K = 0 TO 3    CURSOR X, Y + K    PRINT B$;  NEXT K  RETURN'----------------.CYCLEØHSØCOLOURS'----------------  BANK 0  SYS $7F21, $01 * 16, 16  BANK 128  RETURN'----.INIT'----  PRINT CHR$(147);  Z = FRE(1)  POKE $D021, 0  POKE $D020, 0  GOSUB STOREØDEFAULTØHSØCOLOURS  BANK 0  BLOAD "ASMHELPER"  BANK 128  SONG$ = "FLIGHT.P"  GOSUB LOADØSONG  HSØLEVEL$(0) = "≈XTREME"  HSØLEVEL$(1) = "ƒIFFICULT"  HSØLEVEL$(2) = "ÕEDIUM"  HSØLEVEL$(3) = "≈ASY"  LVLØCLR(0) = 2  LVLØCLR(1) = 7  LVLØCLR(2) = 5  LVLØCLR(3) = 6  RETURN'------------------------.LOADØCURRENTØHIGHØSCORES'------------------------  DOPEN #2, "SCORES", R, U8  FOR K = 0 TO 3    INPUT #2, HSØNAME$(K)    INPUT #2, HSØSCORE(K)  NEXT K  DCLOSE #2  RETURN'-------------.SAVEØHISCORES'-------------  DELETE "SCORES"  DOPEN #2, "SCORES", W, U8  FOR K = 0 TO 3    PRINT #2, HSØNAME$(K)    PRINT #2, HSØSCORE(K)  NEXT K  DCLOSE #2  RETURN'------------------.DRAWØHISCOREØTITLE'------------------  TX = 0 : TY = 2 : TCLR = -1  A$ = "»…«» ”√œ“≈”"  GOSUB PLOTØCENTREDØTEXT  RETURN'-----------------.PLOTØCENTREDØTEXT'-----------------  TX = (160 - LEN(A$)*8) / 2  GOSUB PLOTØTEXT  RETURN'---------.PLOTØTEXT'---------  RAINBOWØFLAG = 0  IF TCLR = -1 THEN RAINBOWØFLAG = 1  FOR K = 0 TO LEN(A$) - 1    C$ = MID$(A$, K + 1, 1)    CHR = ASC(C$)        GOSUB PETSCIIØTOØSCREENCODE    IF RAINBOWØFLAG=1 THEN TCLR = CIDX + $40 : CIDX = MOD(CIDX + 1, 16)    GOSUB PLOTØCHR    TX = TX + 8  NEXT K  Z = FRE(1)  RETURN'--------.PLOTØCHR'--------  ADDR = $2D800 + CHR * 8  FOR YY = 0 TO 7    VL = PEEK(ADDR)    ADDR = ADDR + 1    Y = TY + YY    X = TX    BANK 0    FOR XX = 7 TO 0 STEP -1      IF (VL AND (2 ^ XX)) <> 0 THEN SYS –Ãœ‘Ø–…ÿ≈Ã, X, Y, TCLR      X = X + 1    NEXT XX    BANK 128  NEXT YY  GOSUB PARSEØCURRENTØSEQPTR  RETURN'---------------------.PETSCIIØTOØSCREENCODE'---------------------  BANK 0  POKE $7E2A, CHR  SYS $7F2A  CHR = PEEK($7E2A)  BANK 128  RETURN'-----------------.DRAWØHISCOREØLIST'-----------------  'FOR K = 0 TO 3  '  PRINT HSØLEVEL$(K) ; ": "; HSØNAME$(K); " - SCORE: "; HSØSCORE(K)  'NEXT K  Z = FRE(1)  TY = 14  FOR IDX = 0 TO 3    TX = 0    TCLR = LVLØCLR(IDX)    A$ = HSØLEVEL$(IDX) + ":"    GOSUB PLOTØTEXT    TY = TY + 8    TX = 8    TCLR = -1    A$ = HSØNAME$(IDX)    GOSUB PLOTØTEXT    TCLR = LVLØCLR(IDX)    A$ = STR$(HSØSCORE(IDX))    TX = 160 - LEN(A$) * 8    GOSUB PLOTØTEXT    TY = TY + 12  NEXT IDX  COLOR 10  PRINT "í";  A$ = "–RESS ANY KEY TO EXIT HIGH SCORE MENU"  CURSOR (80 - LEN(A$)) / 2, 48  A$ = CHR$(15) + A$ + CHR$(143)  PRINT A$;  RETURN'-------------------------.STOREØDEFAULTØHSØCOLOURS'-------------------------  FOR K = 0 TO 15    DEFAULTØHSØRED&(K) = PEEK($D110+K)    DEFAULTØHSØGREEN&(K) = PEEK($D210+K)    DEFAULTØHSØBLUE&(K) = PEEK($D310+K)  NEXT K  RETURN'-----------------------.RESTOREØDEFAULTØHSØCOLOURS'-----------------------  FOR K = 0 TO 15    POKE $D110+K, DEFAULTØHSØRED&(K)    POKE $D210+K, DEFAULTØHSØGREEN&(K)    POKE $D310+K, DEFAULTØHSØBLUE&(K)  NEXT K  RETURN'---------.LOADØSONG'---------  DOPEN #2,(SONG$),R,U8  ' LOAD MELODY CHUNKS  ' ------------------  INPUT #2, CHUNKØCNT  FOR CHUNKØIDX = 0 TO CHUNKØCNT - 1    FOR VIDX=0 TO 5      INPUT #2,V$(VIDX, CHUNKØIDX)    NEXT VIDX  NEXT CHUNKØIDX  INPUT #2,TMPO%  TEMPO TMPO%    ' LOAD ENVELOPES  ' --------------  FOR ROW = 0 TO 9    INPUT #2, TMP$    INPUT #2, ATTACK    INPUT #2, DECAY    INPUT #2, SUSTAIN    INPUT #2, RELEASE    INPUT #2, WAVEFORM    INPUT #2, PW    ENVELOPE ROW, ATTACK, DECAY, SUSTAIN, RELEASE, WAVEFORM, PW  NEXT ROW  PRINT  ' LOAD FILTER PRESETS  ' -------------------  FOR ROW = 0 TO 10    INPUT #2, TMP$    INPUT #2, TMP    INPUT #2, TMP    INPUT #2, TMP    INPUT #2, TMP    INPUT #2, TMP    INPUT #2, TMP    INPUT #2, TMP    INPUT #2, TMP  NEXT ROW  ' LOAD SEQUENCE  ' -------------  SEQCNT = 0  INPUT #2, SEQCNT  ROW = 0  DO WHILE ROW < SEQCNT    INPUT #2, SEQØCHUNK(ROW)    INPUT #2, SEQØEXTRA(ROW)    ROW = ROW + 1  LOOP  DCLOSE #2  CHUNKØIDX = 0  RETURN'--------------------.PARSEØCURRENTØSEQPTR'--------------------  RET% = 0  IF PLYPTR = -1 THEN RET%=1:RETURN  IF RPLAY(1)<>0 THEN RET%=1:RETURN  K = SEQØCHUNK(PLYPTR)    IF K >= 0 THEN BEGIN    CHUNKØIDX = K    IF CHUNKØRPT <= 0 THEN CHUNKØRPT = SEQØEXTRA(PLYPTR)    GOSUB PLAYØCHUNKØIDX    PLAYIDX% = PLAYIDX% + 1    RET% = 1  BEND  PLYPTR = PLYPTR + 1  IF K = √ÕƒØÃœœ– THEN PLYPTR = 0  IF PLYPTR >= SEQCNT THEN PLYFLAG = 0 : PLYPTR = -1  RETURN'--------------.PLAYØCHUNKØIDX'--------------  PLAY V$(0, CHUNKØIDX), V$(1, CHUNKØIDX), V$(2, CHUNKØIDX), _       V$(3, CHUNKØIDX), V$(4, CHUNKØIDX), V$(5, CHUNKØIDX)  RETURN