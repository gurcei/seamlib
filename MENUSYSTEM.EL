#OUTPUT "MENUSYSTEM"'--------.DECLARES'--------#DECLARE BKPØD054&, BKPØD058&, BKPØD059&, BKPØD05E&#DECLARE A$, K, TCLR, TX, TY, MYØERR$, IDX, REVØFLAG, CHR, KK#DECLARE X, Y, XX%, YY%, VALUE#DECLARE BOXØX%, BOXØY%, BOXØWIDTH%, BOXØHEIGHT%, BOXØTITLE$#DECLARE LOC#DECLARE APTRØLO, APTRØHI'-------.DEFINES'-------#DEFINE À≈ŸØ≈”√¡–≈ = CHR$(27)#DEFINE À≈ŸØ’– = "ë"#DEFINE À≈ŸØƒœ◊Œ = ""#DEFINE À≈ŸØÃ≈∆‘ = "ù"#DEFINE À≈ŸØ“…«»‘ = ""#DEFINE À≈ŸØ∆1 = "Ö"#DEFINE À≈ŸØ∆3 = "Ü"#DEFINE À≈ŸØ∆4 = "ä"#DEFINE À≈ŸØ∆5 = "á"#DEFINE À≈ŸØ∆7 = "à"#DEFINE À≈ŸØ∆8 = "å"#DEFINE À≈ŸØ≈”√ = CHR$(27)#DEFINE À≈ŸØ“≈÷ØœŒ = ""#DEFINE À≈ŸØ“≈÷Øœ∆∆ = "í"#DEFINE À≈ŸØ“≈‘’“Œ = CHR$(13)#DEFINE À≈ŸØÕ≈«¡Ø¡ = "∞"#DEFINE À≈ŸØÕ≈«¡Ø— = "´"#DEFINE À≈ŸØÕ≈«¡Ø√ = "º"#DEFINE À≈ŸØÕ≈«¡Ø÷ = "æ"#DEFINE À≈ŸØÕ≈«¡Øƒ = "¨"#DEFINE À≈ŸØÕ≈«¡Ø¬ = "ø"#DEFINE À≈ŸØƒ≈Ã = ""#DEFINE À≈ŸØ√Ã“ = "ì"#DEFINE ◊…ƒ‘» = 250#DEFINE ÷…”Ø◊…ƒ‘» = 160#DEFINE œ–Ø√œ–Ÿ = 0#DEFINE œ–ØÕ…ÿ  = 1#DEFINE œ–Ø”◊¡– = 2#DEFINE œ–Ø∆…ÃÃ = 3TRAP RUNSTOPØTRAPPER'----.MAIN'----  GOSUB INIT  GOSUB CLRSCREEN  GOSUB PRINTØGARBAGE  BOXØX% = 10  BOXØY% = 10  BOXØWIDTH% = 30  BOXØHEIGHT% = 40  BOXØTITLE$ = "TEST PROMPT"  GOSUB DRAWØBOX  GOSUB USERØINPUT  END'--------.DRAWØBOX'--------  XX% = BOXØWIDTH% - 1  YY% = BOXØHEIGHT% - 1  ' PRESERVE SCREEN + COLOUR DATA BEHIND BOX  ' SAVE TO $4,4000  LOC = $44000  FOR TY = BOXØY% TO YY%    FOR TX = BOXØX% TO XX%      WPOKE LOC, WPEEK($40800 + TY * ◊…ƒ‘» + TX * 2)      LOC = LOC + 2      WPOKE LOC, WPEEK($FF80000 + TY * ◊…ƒ‘» + TX * 2)      LOC = LOC + 2    NEXT TX  NEXT TY  FOR TX = BOXØX% TO XX%    VALUE = $100B    TY = BOXØY% : GOSUB PLOTØCHAR    VALUE = $100D    TY = YY% : GOSUB PLOTØCHAR  NEXT TX  FOR TY = BOXØY% TO YY%    VALUE = $1009    TX = BOXØX% : GOSUB PLOTØCHAR    VALUE = $100F    TX = XX% : GOSUB PLOTØCHAR  NEXT TY  TX = BOXØX% : TY = BOXØY% : VALUE = $1008 : GOSUB PLOTØCHAR  TX = BOXØX% : TY = YY%    : VALUE = $100A : GOSUB PLOTØCHAR  TX = XX%    : TY = BOXØY% : VALUE = $100E : GOSUB PLOTØCHAR  TX = XX%    : TY = YY%    : VALUE = $1010 : GOSUB PLOTØCHAR  VALUE = 32  FOR TY = BOXØY% + 1 TO YY% - 1    FOR TX = BOXØX% + 1 TO XX% - 1      GOSUB PLOTØCHAR    NEXT TX  NEXT TY      RETURN'--------.HIDEØBOX'--------  LOC = $44000  FOR TY = BOXØY% TO YY%    FOR TX = BOXØX% TO XX%      WPOKE $40800 + TY * ◊…ƒ‘» + TX * 2, WPEEK(LOC)      LOC = LOC + 2      WPOKE $FF80000 + TY * ◊…ƒ‘» + TX * 2, WPEEK(LOC)      LOC = LOC + 2    NEXT TX  NEXT TY  RETURN'---------.PLOTØCHAR'---------  WPOKE $40800 + TY * ◊…ƒ‘» + TX * 2, VALUE  WPOKE $FF80000 + TY * ◊…ƒ‘» + TX * 2, TCLR * 256  RETURN  '-------------.PRINTØGARBAGE'-------------  FOR KK = 0 TO 49    TCLR = 0 : TX = 0 : TY = KK : A$ = "0123456789" : A$ = A$ + A$ + A$ + A$    A$ = A$ + A$    GOSUB DRAWØTEXT  NEXT KK  RETURN'----.INIT'----  BANK 128  KEY OFF  BLOAD "GAME.PAL",P($FFD3100)  BLOAD "CHARS.BIN",P($40000),R  BLOAD "ASMHELPER"  PRINT "ì";À≈ŸØ≈”√¡–≈;"5";    BKPØD054& = PEEK($D054)  BKPØD058& = PEEK($D058)  BKPØD059& = PEEK($D059)  BKPØD05E& = PEEK($D05E)  APTRØLO = POINTER(A$) AND $FF  APTRØHI = POINTER(A$) / 256  ' SET ”≈¡Õ MODE √»“16 + ∆√Ã“»…  SETBIT $D054, 0  SETBIT $D054, 2  WPOKE $D058, ◊…ƒ‘»  POKE $D05E, ◊…ƒ‘» / 2  POKE $D021, 14  POKE $D020, 0  ' $1000 = SOLID FCM CHAR  FOR K = 0 TO 63    POKE $40000 + K, $FF  NEXT K  ' $1001 = BOX CHAR  FOR K = 0 TO 63    IF INT(K / 8) = 0 OR INT(K / 8) = 7 THEN POKE $40040 + K, $FF:GOTO NXT    IF MOD(K, 8) = 0 OR MOD(K, 8) = 7 THEN POKE $40040 + K, $FF:GOTO NXT    POKE $40040 + K, $00.NXT  NEXT K  RETURN'---------------.RUNSTOPØTRAPPER'---------------  ' IF ER<>30 THEN RESUME  ' IGNORE EVERYTHING EXCEPT RUN/STOP  MYØERR$ = "?" + ERR$(ER) + " IN LINE " + STR$(EL).CLEANUP  PRINT "ì";MYØERR$  TRAP  KEY ON  POKE $D054, BKPØD054&  POKE $D058, BKPØD058&  POKE $D059, BKPØD059&  POKE $D05E, BKPØD05E&  END'----------.USERØINPUT'----------  DO WHILE 1    GET KEY A$    IF A$ = À≈ŸØÕ≈«¡Ø— THEN GOTO CLEANUP    GOSUB HIDEØBOX  LOOP  END'---------.DRAWØTEXT'---------  BANK 0  POKE $160D, TX  POKE $160E, TY  POKE $160F, TCLR  SYS $1613, 0, APTRØLO, APTRØHI  BANK 128  RETURN  IDX = 0  REVØFLAG = 0  FOR K = 1 TO LEN(A$)    CHR = ASC(MID$(A$,K,1))    IF MID$(A$,K,1) = À≈ŸØ“≈÷ØœŒ THEN REVØFLAG = 1 : GOTO NXTDT    IF MID$(A$,K,1) = À≈ŸØ“≈÷Øœ∆∆ THEN REVØFLAG = 0 : GOTO NXTDT    GOSUB PETSCIIØTOØSCREENCODE    IF REVØFLAG = 1 THEN CHR = CHR OR $80    WPOKE $40800 + TY * ◊…ƒ‘» + (TX + IDX) * 2, CHR    POKE $FF80000 + TY * ◊…ƒ‘» + (TX + IDX) * 2 + 1, TCLR    IDX = IDX + 1.NXTDT  NEXT K  RETURN'---------------------.PETSCIIØTOØSCREENCODE'---------------------  IF CHR>=$00 AND CHR<=$1F THEN CHR = CHR OR $80 : RETURN  IF CHR>=$20 AND CHR<=$3F THEN RETURN  IF CHR>=$40 AND CHR<=$5F THEN CHR=CHR AND $BF : RETURN  IF CHR>=$60 AND CHR<=$7F THEN CHR=CHR AND $DF : RETURN  IF CHR>=$80 AND CHR<=$9F THEN CHR=CHR OR $40 : RETURN  IF CHR>=$A0 AND CHR<=$BF THEN CHR=(CHR AND $7F) OR $40 : RETURN  IF CHR>=$C0 AND CHR<=$FE THEN CHR=CHR AND $7F : RETURN  RETURN'---------.CLRSCREEN'---------  EDMA œ–Ø∆…ÃÃ, ◊…ƒ‘» * 50, 32, $40800  EDMA œ–Ø∆…ÃÃ, ◊…ƒ‘» * 50, 0, $FF80000  ' CLEAR SCREEN  FOR Y = 0 TO 49   FOR X = 0 TO 79     POKE $40800 + Y * ◊…ƒ‘» + X * 2 + 1, 0   NEXT X  NEXT Y  RETURN